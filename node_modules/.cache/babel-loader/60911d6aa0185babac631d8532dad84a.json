{"ast":null,"code":"import e, { useRef as n, useReducer as t, createContext as r, useEffect as i, useLayoutEffect as o, useMemo as a, useCallback as c, useState as u, useContext as l, Children as s, cloneElement as d } from \"react\";\nimport { createPortal as v } from \"react-dom\";\n\nfunction f() {\n  return f = Object.assign || function (e) {\n    for (var n = 1; n < arguments.length; n++) {\n      var t = arguments[n];\n\n      for (var r in t) {\n        Object.prototype.hasOwnProperty.call(t, r) && (e[r] = t[r]);\n      }\n    }\n\n    return e;\n  }, f.apply(this, arguments);\n}\n\nfunction h(e, n) {\n  if (null == e) return {};\n  var t,\n      r,\n      i = {},\n      o = Object.keys(e);\n\n  for (r = 0; r < o.length; r++) {\n    n.indexOf(t = o[r]) >= 0 || (i[t] = e[t]);\n  }\n\n  return i;\n}\n\nfunction m(e) {\n  var t = n({\n    fn: e,\n    curr: void 0\n  }).current;\n\n  if (t.fn = e, !t.curr) {\n    var r = Object.create(null);\n    Object.keys(e).forEach(function (e) {\n      r[e] = function () {\n        var n;\n        return (n = t.fn[e]).call.apply(n, [t.fn].concat([].slice.call(arguments)));\n      };\n    }), t.curr = r;\n  }\n\n  return t.curr;\n}\n\nfunction g(e) {\n  return t(function (e, n) {\n    return f({}, e, \"function\" == typeof n ? n(e) : n);\n  }, e);\n}\n\nvar p = r(void 0),\n    w = \"undefined\" != typeof window && \"ontouchstart\" in window,\n    y = function y(e, n, t) {\n  return Math.max(Math.min(e, t), n);\n},\n    x = function x(e, n, t) {\n  return void 0 === n && (n = 0), void 0 === t && (t = 0), y(e, 1 * (1 - t), Math.max(6, n) * (1 + t));\n},\n    C = \"undefined\" == typeof window || /ServerSideRendering/.test(navigator && navigator.userAgent) ? i : o;\n\nfunction b(e, t, r) {\n  var o = n(t);\n  o.current = t, i(function () {\n    function n(e) {\n      o.current(e);\n    }\n\n    return e && window.addEventListener(e, n, r), function () {\n      e && window.removeEventListener(e, n);\n    };\n  }, [e]);\n}\n\nvar E = [\"container\"];\n\nfunction k(n) {\n  var t = n.container,\n      r = void 0 === t ? document.body : t,\n      i = h(n, E);\n  return v(e.createElement(\"div\", f({}, i)), r);\n}\n\nfunction P(n) {\n  return e.createElement(\"svg\", f({\n    width: \"44\",\n    height: \"44\",\n    viewBox: \"0 0 768 768\"\n  }, n), e.createElement(\"path\", {\n    d: \"M607.5 205.5l-178.5 178.5 178.5 178.5-45 45-178.5-178.5-178.5 178.5-45-45 178.5-178.5-178.5-178.5 45-45 178.5 178.5 178.5-178.5z\"\n  }));\n}\n\nfunction _(n) {\n  return e.createElement(\"svg\", f({\n    width: \"44\",\n    height: \"44\",\n    viewBox: \"0 0 768 768\"\n  }, n), e.createElement(\"path\", {\n    d: \"M640.5 352.5v63h-390l178.5 180-45 45-256.5-256.5 256.5-256.5 45 45-178.5 180h390z\"\n  }));\n}\n\nfunction M(n) {\n  return e.createElement(\"svg\", f({\n    width: \"44\",\n    height: \"44\",\n    viewBox: \"0 0 768 768\"\n  }, n), e.createElement(\"path\", {\n    d: \"M384 127.5l256.5 256.5-256.5 256.5-45-45 178.5-180h-390v-63h390l-178.5-180z\"\n  }));\n}\n\nfunction Y() {\n  return i(function () {\n    var e = document.body.style,\n        n = e.overflow;\n    return e.overflow = \"hidden\", function () {\n      e.overflow = n;\n    };\n  }, []), null;\n}\n\nfunction X(e) {\n  var n = e.touches[0],\n      t = n.clientX,\n      r = n.clientY;\n\n  if (e.touches.length >= 2) {\n    var i = e.touches[1],\n        o = i.clientX,\n        a = i.clientY;\n    return [(t + o) / 2, (r + a) / 2, Math.sqrt(Math.pow(o - t, 2) + Math.pow(a - r, 2))];\n  }\n\n  return [t, r, 0];\n}\n\nvar N = function N(e, n, t, r) {\n  var i = t * n,\n      o = (i - r) / 2,\n      a = void 0,\n      c = e;\n  return i <= r ? (a = 1, c = 0) : e > 0 && o - e <= 0 ? (a = 2, c = o) : e < 0 && o + e <= 0 && (a = 3, c = -o), [a, c];\n};\n\nfunction W(e, n, t, r, i, o, a, c, u, l) {\n  void 0 === a && (a = innerWidth / 2), void 0 === c && (c = innerHeight / 2), void 0 === u && (u = 0), void 0 === l && (l = 0);\n  var s = N(e, o, t, innerWidth)[0],\n      d = N(n, o, r, innerHeight),\n      v = innerWidth / 2,\n      f = innerHeight / 2;\n  return {\n    x: a - o / i * (a - (v + e)) - v + (r / t >= 3 && t * o === innerWidth ? 0 : s ? u / 2 : u),\n    y: c - o / i * (c - (f + n)) - f + (d[0] ? l / 2 : l),\n    lastCX: a,\n    lastCY: c\n  };\n}\n\nfunction S(e, n, t) {\n  var r = e % 180 != 0;\n  return r ? [t, n, r] : [n, t, r];\n}\n\nfunction T(e, n, t) {\n  var r = S(t, innerWidth, innerHeight),\n      i = r[0],\n      o = r[1],\n      a = 0,\n      c = i,\n      u = o,\n      l = e / n * o,\n      s = n / e * i;\n  return e < i && n < o ? (c = e, u = n) : e < i && n >= o ? c = l : e >= i && n < o || e / n > i / o ? u = s : n / e >= 3 && !r[2] ? a = ((u = s) - o) / 2 : c = l, {\n    width: c,\n    height: u,\n    x: 0,\n    y: a,\n    pause: !0\n  };\n}\n\nfunction V(e, t) {\n  var r = t.leading,\n      i = void 0 !== r && r,\n      o = t.maxWait,\n      a = t.wait,\n      u = void 0 === a ? o || 0 : a,\n      l = n(e);\n  l.current = e;\n\n  var s = n(0),\n      d = n(),\n      v = function v() {\n    return d.current && clearTimeout(d.current);\n  },\n      f = c(function () {\n    var e = [].slice.call(arguments),\n        n = Date.now();\n\n    function t() {\n      s.current = n, v(), l.current.apply(null, e);\n    }\n\n    var r = s.current,\n        a = n - r;\n\n    if (0 === r && (i && t(), s.current = n), void 0 !== o) {\n      if (a > o) return void t();\n    } else a < u && (s.current = n);\n\n    v(), d.current = setTimeout(function () {\n      t(), s.current = 0;\n    }, u);\n  }, [u, o, i]);\n\n  return f.cancel = v, f;\n}\n\nvar R = function R(e, n, t) {\n  return I(e, n, t, 100, function (e) {\n    return e;\n  }, function () {\n    return I(n, e, t);\n  });\n},\n    A = function A(e) {\n  return 1 - Math.pow(1 - e, 4);\n};\n\nfunction I(e, n, t, r, i, o) {\n  void 0 === r && (r = 400), void 0 === i && (i = A);\n  var a = n - e;\n\n  if (0 !== a) {\n    var c = Date.now(),\n        u = 0,\n        l = function l() {\n      var n = Math.min(1, (Date.now() - c) / r);\n      t(e + i(n) * a) && n < 1 ? s() : (cancelAnimationFrame(u), n >= 1 && o && o());\n    };\n\n    s();\n  }\n\n  function s() {\n    u = requestAnimationFrame(l);\n  }\n}\n\nvar H = {\n  T: 0,\n  L: 0,\n  W: 0,\n  H: 0,\n  FIT: void 0\n},\n    L = function L() {\n  var e = n(!1);\n  return i(function () {\n    return e.current = !0, function () {\n      e.current = !1;\n    };\n  }, []), e;\n},\n    F = [\"className\"];\n\nfunction D(n) {\n  var t = n.className,\n      r = h(n, F);\n  return e.createElement(\"div\", f({\n    className: \"PhotoView__Spinner \" + t\n  }, r), e.createElement(\"svg\", {\n    viewBox: \"0 0 32 32\",\n    width: \"36\",\n    height: \"36\",\n    fill: \"white\"\n  }, e.createElement(\"path\", {\n    opacity: \".25\",\n    d: \"M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4\"\n  }), e.createElement(\"path\", {\n    d: \"M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z\"\n  })));\n}\n\nvar O = [\"src\", \"loaded\", \"broken\", \"className\", \"onPhotoLoad\", \"loadingElement\", \"brokenElement\"];\n\nfunction B(n) {\n  var t = n.src,\n      r = n.loaded,\n      i = n.broken,\n      o = n.className,\n      a = n.onPhotoLoad,\n      c = n.loadingElement,\n      u = n.brokenElement,\n      l = h(n, O),\n      s = L();\n  return t && !i ? e.createElement(e.Fragment, null, e.createElement(\"img\", f({\n    className: \"PhotoView__Photo\" + (o ? \" \" + o : \"\"),\n    src: t,\n    onLoad: function onLoad(e) {\n      var n = e.target;\n      s.current && a({\n        loaded: !0,\n        naturalWidth: n.naturalWidth,\n        naturalHeight: n.naturalHeight\n      });\n    },\n    onError: function onError() {\n      s.current && a({\n        broken: !0\n      });\n    },\n    alt: \"\"\n  }, l)), !r && (e.createElement(\"span\", {\n    className: \"PhotoView__icon\"\n  }, c) || e.createElement(D, {\n    className: \"PhotoView__icon\"\n  }))) : u ? e.createElement(\"span\", {\n    className: \"PhotoView__icon\"\n  }, \"function\" == typeof u ? u({\n    src: t\n  }) : u) : null;\n}\n\nvar z = {\n  naturalWidth: void 0,\n  naturalHeight: void 0,\n  width: void 0,\n  height: void 0,\n  loaded: void 0,\n  broken: !1,\n  x: 0,\n  y: 0,\n  touched: !1,\n  maskTouched: !1,\n  rotate: 0,\n  scale: 1,\n  CX: 0,\n  CY: 0,\n  lastX: 0,\n  lastY: 0,\n  lastCX: 0,\n  lastCY: 0,\n  lastScale: 1,\n  touchTime: 0,\n  touchLength: 0,\n  pause: !0,\n  stopRaf: !0,\n  reach: void 0\n};\n\nfunction j(t) {\n  var r = t.item,\n      o = r.src,\n      a = r.render,\n      c = r.width,\n      l = void 0 === c ? 0 : c,\n      s = r.height,\n      d = void 0 === s ? 0 : s,\n      v = r.originRef,\n      h = t.visible,\n      p = t.speed,\n      y = t.easing,\n      E = t.wrapClassName,\n      k = t.className,\n      P = t.style,\n      _ = t.loadingElement,\n      M = t.brokenElement,\n      Y = t.onPhotoTap,\n      A = t.onMaskTap,\n      F = t.onReachMove,\n      D = t.onReachUp,\n      O = t.onPhotoResize,\n      j = t.isActive,\n      q = t.expose,\n      K = g(z),\n      U = K[0],\n      G = K[1],\n      J = n(0),\n      Q = L(),\n      Z = U.naturalWidth,\n      $ = void 0 === Z ? l : Z,\n      ee = U.naturalHeight,\n      ne = void 0 === ee ? d : ee,\n      te = U.width,\n      re = void 0 === te ? l : te,\n      ie = U.height,\n      oe = void 0 === ie ? d : ie,\n      ae = U.loaded,\n      ce = void 0 === ae ? !o : ae,\n      ue = U.broken,\n      le = U.x,\n      se = U.y,\n      de = U.touched,\n      ve = U.stopRaf,\n      fe = U.maskTouched,\n      he = U.rotate,\n      me = U.scale,\n      ge = U.CX,\n      pe = U.CY,\n      we = U.lastX,\n      ye = U.lastY,\n      xe = U.lastCX,\n      Ce = U.lastCY,\n      be = U.lastScale,\n      Ee = U.touchTime,\n      ke = U.touchLength,\n      Pe = U.pause,\n      _e = U.reach,\n      Me = m({\n    onScale: function onScale(e) {\n      return Ye(x(e));\n    },\n    onRotate: function onRotate(e) {\n      he !== e && (q({\n        rotate: e\n      }), G(f({\n        rotate: e\n      }, T($, ne, e))));\n    }\n  });\n\n  function Ye(e, n, t) {\n    me !== e && (q({\n      scale: e\n    }), G(f({\n      scale: e\n    }, W(le, se, re, oe, me, e, n, t), e <= 1 && {\n      x: 0,\n      y: 0\n    })));\n  }\n\n  var Xe = V(function (e, n, t) {\n    if (void 0 === t && (t = 0), (de || fe) && j) {\n      var r = S(he, re, oe),\n          i = r[0],\n          o = r[1];\n\n      if (0 === t && 0 === J.current) {\n        var a = Math.abs(e - ge) <= 20,\n            c = Math.abs(n - pe) <= 20;\n        if (a && c) return void G({\n          lastCX: e,\n          lastCY: n\n        });\n        J.current = a ? n > pe ? 3 : 2 : 1;\n      }\n\n      var u = e - xe,\n          l = n - Ce,\n          s = void 0;\n\n      if (0 === t) {\n        var d = N(u + we, me, i, innerWidth)[0],\n            v = N(l + ye, me, o, innerHeight);\n        s = function (e, n, t, r) {\n          return n && 1 === e || \"x\" === r ? \"x\" : t && e > 1 || \"y\" === r ? \"y\" : void 0;\n        }(J.current, d, v[0], _e), void 0 !== s && F(s, e, n, me);\n      }\n\n      if (\"x\" === s || fe) return void G({\n        reach: \"x\"\n      });\n      var h = x(me + (t - ke) / 100 / 2 * me, $ / re, .2);\n      q({\n        scale: h\n      }), G(f({\n        touchLength: t,\n        reach: s,\n        scale: h\n      }, W(le, se, re, oe, me, h, e, n, u, l)));\n    }\n  }, {\n    maxWait: 8\n  });\n\n  function Ne(e) {\n    return !ve && !de && (Q.current && G(f({}, e, {\n      pause: h\n    })), Q.current);\n  }\n\n  var We,\n      Se,\n      Te,\n      Ve,\n      Re,\n      Ae,\n      Ie,\n      He,\n      Le = (Re = function Re(e) {\n    return Ne({\n      x: e\n    });\n  }, Ae = function Ae(e) {\n    return Ne({\n      y: e\n    });\n  }, Ie = function Ie(e) {\n    return Q.current && (q({\n      scale: e\n    }), G({\n      scale: e\n    })), !de && Q.current;\n  }, He = m({\n    X: function X(e) {\n      return Re(e);\n    },\n    Y: function Y(e) {\n      return Ae(e);\n    },\n    S: function S(e) {\n      return Ie(e);\n    }\n  }), function (e, n, t, r, i, o, a, c, u, l, s) {\n    var d = S(l, i, o),\n        v = d[0],\n        f = d[1],\n        h = N(e, c, v, innerWidth),\n        m = h[0],\n        g = h[1],\n        p = N(n, c, f, innerHeight),\n        w = p[0],\n        y = p[1],\n        x = Date.now() - s;\n\n    if (x >= 200 || c != a || Math.abs(u - a) > 1) {\n      var C = W(e, n, i, o, a, c),\n          b = C.x,\n          E = C.y,\n          k = m ? g : b !== e ? b : null,\n          P = w ? y : E !== n ? E : null;\n      return null !== k && I(e, k, He.X), null !== P && I(n, P, He.Y), void (c != a && I(a, c, He.S));\n    }\n\n    var _ = (e - t) / x,\n        M = (n - r) / x,\n        Y = Math.sqrt(Math.pow(_, 2) + Math.pow(M, 2)),\n        X = !1,\n        T = !1;\n\n    !function (e, n) {\n      var t = e,\n          r = 0,\n          i = void 0,\n          o = 0,\n          a = function a(o) {\n        i || (i = o);\n        var a = o - i,\n            l = Math.sign(e),\n            s = -.001 * l,\n            d = Math.sign(-t) * Math.pow(t, 2) * 2e-4,\n            v = t * a + (s + d) * Math.pow(a, 2) / 2;\n        r += v, i = o, l * (t += (s + d) * a) <= 0 ? u() : n(r) ? c() : u();\n      };\n\n      function c() {\n        o = requestAnimationFrame(a);\n      }\n\n      function u() {\n        cancelAnimationFrame(o);\n      }\n\n      c();\n    }(Y, function (t) {\n      var r = e + t * (_ / Y),\n          i = n + t * (M / Y),\n          o = N(r, a, v, innerWidth),\n          c = o[0],\n          u = o[1],\n          l = N(i, a, f, innerHeight),\n          s = l[0],\n          d = l[1];\n      if (c && !X && (X = !0, m ? I(r, u, He.X) : R(u, r + (r - u), He.X)), s && !T && (T = !0, w ? I(i, d, He.Y) : R(d, i + (i - d), He.Y)), X && T) return !1;\n      var h = X || He.X(u),\n          g = T || He.Y(d);\n      return h && g;\n    });\n  }),\n      Fe = (We = Y, Se = function Se(e, n) {\n    _e || Ye(1 !== me ? 1 : Math.max(2, $ / re), e, n);\n  }, Te = n(0), Ve = V(function () {\n    Te.current = 0, We.apply(void 0, [].slice.call(arguments));\n  }, {\n    wait: 300\n  }), function () {\n    var e = [].slice.call(arguments);\n    Te.current += 1, Ve.apply(void 0, e), Te.current >= 2 && (Ve.cancel(), Te.current = 0, Se.apply(void 0, e));\n  });\n\n  function De(e, n) {\n    if (J.current = 0, (de || fe) && j) {\n      G({\n        touched: !1,\n        maskTouched: !1,\n        pause: !1,\n        stopRaf: !1,\n        reach: void 0\n      });\n      var t = x(me, $ / re);\n\n      if (Le(le, se, we, ye, re, oe, me, t, be, he, Ee), D(e, n), ge === e && pe === n) {\n        if (de) return void Fe(e, n);\n        fe && A(e, n);\n      }\n    }\n  }\n\n  function Oe(e, n, t) {\n    void 0 === t && (t = 0), G({\n      touched: !0,\n      CX: e,\n      CY: n,\n      lastCX: e,\n      lastCY: n,\n      lastX: le,\n      lastY: se,\n      lastScale: me,\n      touchLength: t,\n      touchTime: Date.now()\n    });\n  }\n\n  function Be(e) {\n    G({\n      maskTouched: !0,\n      CX: e.clientX,\n      CY: e.clientY,\n      lastX: le,\n      lastY: se\n    });\n  }\n\n  b(w ? void 0 : \"mousemove\", function (e) {\n    e.preventDefault(), Xe(e.clientX, e.clientY);\n  }), b(w ? void 0 : \"mouseup\", function (e) {\n    De(e.clientX, e.clientY);\n  }), b(w ? \"touchmove\" : void 0, function (e) {\n    e.preventDefault();\n    var n = X(e);\n    Xe.apply(void 0, n);\n  }, {\n    passive: !1\n  }), b(w ? \"touchend\" : void 0, function (e) {\n    var n = e.changedTouches[0];\n    De(n.clientX, n.clientY);\n  }, {\n    passive: !1\n  }), b(\"resize\", V(function () {\n    ce && !de && (G(T($, ne, he)), O());\n  }, {\n    maxWait: 8\n  })), C(function () {\n    j && q(f({\n      scale: me,\n      rotate: he\n    }, Me));\n  }, [j]);\n\n  var ze = function (e, t, r, o, a, c, l, s, d, v) {\n    var f = function (e, t, r, i, o) {\n      var a = n(!1),\n          c = g({\n        lead: !0,\n        scale: r\n      }),\n          u = c[0],\n          l = u.lead,\n          s = u.scale,\n          d = c[1],\n          v = V(function (e) {\n        try {\n          return o(!0), d({\n            lead: !1,\n            scale: e\n          }), Promise.resolve();\n        } catch (e) {\n          return Promise.reject(e);\n        }\n      }, {\n        wait: i\n      });\n      return C(function () {\n        a.current ? (o(!1), d({\n          lead: !0\n        }), v(r)) : a.current = !0;\n      }, [r]), l ? [e * s, t * s, r / s] : [e * r, t * r, 1];\n    }(c, l, s, d, v),\n        h = f[0],\n        p = f[1],\n        w = f[2],\n        y = function (e, t, r, o, a) {\n      var c = u(H),\n          l = c[0],\n          s = c[1],\n          d = u(0),\n          v = d[0],\n          f = d[1],\n          h = n(),\n          g = m({\n        OK: function OK() {\n          return e && f(4);\n        }\n      });\n\n      function p(e) {\n        a(!1), f(e);\n      }\n\n      return i(function () {\n        if (h.current || (h.current = Date.now()), r) {\n          if (function (e, n) {\n            var t = e && e.current;\n\n            if (t && 1 === t.nodeType) {\n              var r = t.getBoundingClientRect();\n              n({\n                T: r.top,\n                L: r.left,\n                W: r.width,\n                H: r.height,\n                FIT: \"IMG\" === t.tagName ? getComputedStyle(t).objectFit : void 0\n              });\n            }\n          }(t, s), e) return Date.now() - h.current < 250 ? (f(1), requestAnimationFrame(function () {\n            f(2), requestAnimationFrame(function () {\n              return p(3);\n            });\n          }), void setTimeout(g.OK, o)) : void f(4);\n          p(5);\n        }\n      }, [e, r]), [v, l];\n    }(e, t, r, d, v),\n        x = y[0],\n        b = y[1],\n        E = b.W,\n        k = b.FIT,\n        P = innerWidth / 2,\n        _ = innerHeight / 2,\n        M = x < 3 || x > 4;\n\n    return [M ? E ? b.L : P : o + (P - c * s / 2), M ? E ? b.T : _ : a + (_ - l * s / 2), h, M && k ? h * (b.H / E) : p, 0 === x ? w : M ? E / (c * s) || .01 : w, M ? k ? 1 : 0 : 1, x, k];\n  }(h, v, ce, le, se, re, oe, me, p, function (e) {\n    return G({\n      pause: e\n    });\n  }),\n      je = ze[4],\n      qe = ze[6],\n      Ke = \"transform \" + p + \"ms \" + y,\n      Ue = {\n    className: k,\n    onMouseDown: w ? void 0 : function (e) {\n      e.stopPropagation(), 0 === e.button && Oe(e.clientX, e.clientY, 0);\n    },\n    onTouchStart: w ? function (e) {\n      e.stopPropagation(), Oe.apply(void 0, X(e));\n    } : void 0,\n    onWheel: function onWheel(e) {\n      if (!_e) {\n        var n = x(me - e.deltaY / 100 / 2, $ / re);\n        G({\n          stopRaf: !0\n        }), Ye(n, e.clientX, e.clientY);\n      }\n    },\n    style: {\n      width: ze[2],\n      height: ze[3],\n      opacity: ze[5],\n      objectFit: 4 === qe ? void 0 : ze[7],\n      transform: he ? \"rotate(\" + he + \"deg)\" : void 0,\n      transition: qe > 2 ? Ke + \", opacity \" + p + \"ms ease, height \" + (qe < 4 ? p / 2 : qe > 4 ? p : 0) + \"ms \" + y : void 0\n    }\n  };\n\n  return e.createElement(\"div\", {\n    className: \"PhotoView__PhotoWrap\" + (E ? \" \" + E : \"\"),\n    style: P,\n    onMouseDown: !w && j ? Be : void 0,\n    onTouchStart: w && j ? function (e) {\n      return Be(e.touches[0]);\n    } : void 0\n  }, e.createElement(\"div\", {\n    className: \"PhotoView__PhotoBox\",\n    style: {\n      transform: \"matrix(\" + je + \", 0, 0, \" + je + \", \" + ze[0] + \", \" + ze[1] + \")\",\n      transition: de || Pe ? void 0 : Ke,\n      willChange: j ? \"transform\" : void 0\n    }\n  }, o ? e.createElement(B, f({\n    src: o,\n    loaded: ce,\n    broken: ue\n  }, Ue, {\n    onPhotoLoad: function onPhotoLoad(e) {\n      G(f({}, e, e.loaded && T(e.naturalWidth || 0, e.naturalHeight || 0, he)));\n    },\n    loadingElement: _,\n    brokenElement: M\n  })) : a && a({\n    attrs: Ue,\n    scale: je,\n    rotate: he\n  })));\n}\n\nvar q = {\n  x: 0,\n  touched: !1,\n  pause: !1,\n  lastCX: void 0,\n  lastCY: void 0,\n  bg: void 0,\n  lastBg: void 0,\n  overlay: !0,\n  minimal: !0,\n  scale: 1,\n  rotate: 0\n};\n\nfunction K(r) {\n  var i = r.loop,\n      o = void 0 === i ? 3 : i,\n      c = r.speed,\n      l = r.easing,\n      s = r.photoClosable,\n      d = r.maskClosable,\n      v = void 0 === d || d,\n      f = r.maskOpacity,\n      h = void 0 === f ? 1 : f,\n      p = r.pullClosable,\n      x = void 0 === p || p,\n      E = r.bannerVisible,\n      X = void 0 === E || E,\n      N = r.overlayRender,\n      W = r.toolbarRender,\n      S = r.className,\n      T = r.maskClassName,\n      V = r.photoClassName,\n      R = r.photoWrapClassName,\n      A = r.loadingElement,\n      I = r.brokenElement,\n      H = r.images,\n      L = r.index,\n      F = void 0 === L ? 0 : L,\n      D = r.onIndexChange,\n      O = r.visible,\n      B = r.onClose,\n      z = r.afterClose,\n      K = r.portalContainer,\n      U = g(q),\n      G = U[0],\n      J = U[1],\n      Q = u(0),\n      Z = Q[0],\n      $ = Q[1],\n      ee = G.x,\n      ne = G.touched,\n      te = G.pause,\n      re = G.lastCX,\n      ie = G.lastCY,\n      oe = G.bg,\n      ae = void 0 === oe ? h : oe,\n      ce = G.lastBg,\n      ue = G.overlay,\n      le = G.minimal,\n      se = G.scale,\n      de = G.rotate,\n      ve = G.onScale,\n      fe = G.onRotate,\n      he = r.hasOwnProperty(\"index\"),\n      me = he ? F : Z,\n      ge = he ? D : $,\n      pe = n(me),\n      we = H.length,\n      ye = H[me],\n      xe = \"boolean\" == typeof o ? o : we > o,\n      Ce = function (e, r) {\n    var i = t(function (e) {\n      return !e;\n    }, !1)[1],\n        o = n(0),\n        c = function (t, r) {\n      var i = n(t);\n\n      function c(e) {\n        i.current = e;\n      }\n\n      return a(function () {\n        !function (n) {\n          e ? (n(e), o.current = 1) : o.current = 2;\n        }(c);\n      }, [t]), [i.current, c];\n    }(e),\n        u = c[1];\n\n    return [c[0], o.current, function () {\n      i(), 2 === o.current && (u(!1), r && r()), o.current = 0;\n    }];\n  }(O, z),\n      be = Ce[0],\n      Ee = Ce[1],\n      ke = Ce[2];\n\n  C(function () {\n    if (be) return J({\n      pause: !0,\n      x: me * -(innerWidth + 20)\n    }), void (pe.current = me);\n    J(q);\n  }, [be]);\n  var Pe = m({\n    close: function close(e) {\n      fe && fe(0), J({\n        overlay: !0,\n        lastBg: ae\n      }), B(e);\n    },\n    changeIndex: function changeIndex(e, n) {\n      void 0 === n && (n = !1);\n      var t = xe ? pe.current + (e - me) : e,\n          r = we - 1,\n          i = y(t, 0, r),\n          o = xe ? t : i,\n          a = innerWidth + 20;\n      J({\n        touched: !1,\n        lastCX: void 0,\n        lastCY: void 0,\n        x: -a * o,\n        pause: n\n      }), pe.current = o, ge && ge(xe ? e < 0 ? r : e > r ? 0 : e : i);\n    }\n  }),\n      _e = Pe.close,\n      Me = Pe.changeIndex;\n\n  function Ye(e) {\n    return e ? _e() : J({\n      overlay: !ue\n    });\n  }\n\n  function Xe() {\n    J({\n      x: -(innerWidth + 20) * me,\n      lastCX: void 0,\n      lastCY: void 0,\n      pause: !0\n    }), pe.current = me;\n  }\n\n  function Ne(e, n, t, r) {\n    \"x\" === e ? function (e) {\n      if (void 0 !== re) {\n        var n = e - re,\n            t = n;\n        !xe && (0 === me && n > 0 || me === we - 1 && n < 0) && (t = n / 2), J({\n          touched: !0,\n          lastCX: re,\n          x: -(innerWidth + 20) * pe.current + t,\n          pause: !1\n        });\n      } else J({\n        touched: !0,\n        lastCX: e,\n        x: ee,\n        pause: !1\n      });\n    }(n) : \"y\" === e && function (e, n) {\n      if (void 0 !== ie) {\n        var t = null === h ? null : y(h, .01, h - Math.abs(e - ie) / 100 / 4);\n        J({\n          touched: !0,\n          lastCY: ie,\n          bg: 1 === n ? t : h,\n          minimal: 1 === n\n        });\n      } else J({\n        touched: !0,\n        lastCY: e,\n        bg: ae,\n        minimal: !0\n      });\n    }(t, r);\n  }\n\n  function We(e, n) {\n    var t = e - (null != re ? re : e),\n        r = n - (null != ie ? ie : n),\n        i = !1;\n    if (t < -40) Me(me + 1);else if (t > 40) Me(me - 1);else {\n      var o = -(innerWidth + 20) * pe.current;\n      Math.abs(r) > 100 && le && x && (i = !0, _e()), J({\n        touched: !1,\n        x: o,\n        lastCX: void 0,\n        lastCY: void 0,\n        bg: h,\n        overlay: !!i || ue\n      });\n    }\n  }\n\n  b(\"keydown\", function (e) {\n    if (O) switch (e.key) {\n      case \"ArrowLeft\":\n        Me(me - 1, !0);\n        break;\n\n      case \"ArrowRight\":\n        Me(me + 1, !0);\n        break;\n\n      case \"Escape\":\n        _e();\n\n    }\n  });\n\n  var Se = function (e, n, t) {\n    return a(function () {\n      var r = e.length;\n      return t ? e.concat(e).concat(e).slice(r + n - 1, r + n + 2) : e.slice(Math.max(n - 1, 0), Math.min(n + 2, r + 1));\n    }, [e, n, t]);\n  }(H, me, xe);\n\n  if (!be) return null;\n  var Te = ue && !Ee,\n      Ve = O ? ae : ce,\n      Re = ve && fe && {\n    images: H,\n    index: me,\n    visible: O,\n    onClose: _e,\n    onIndexChange: Me,\n    overlayVisible: Te,\n    overlay: ye && ye.overlay,\n    scale: se,\n    rotate: de,\n    onScale: ve,\n    onRotate: fe\n  },\n      Ae = c ? c(Ee) : 400,\n      Ie = l ? l(Ee) : \"cubic-bezier(0.25, 0.8, 0.25, 1)\",\n      He = c ? c(3) : 600,\n      Le = l ? l(3) : \"cubic-bezier(0.25, 0.8, 0.25, 1)\";\n  return e.createElement(k, {\n    className: \"PhotoView-Portal\" + (Te ? \"\" : \" PhotoView-Slider__clean\") + (O ? \"\" : \" PhotoView-Slider__willClose\") + (S ? \" \" + S : \"\"),\n    role: \"dialog\",\n    onClick: function onClick(e) {\n      return e.stopPropagation();\n    },\n    container: K\n  }, O && e.createElement(Y, null), e.createElement(\"div\", {\n    className: \"PhotoView-Slider__Backdrop\" + (T ? \" \" + T : \"\") + (1 === Ee ? \" PhotoView-Slider__fadeIn\" : 2 === Ee ? \" PhotoView-Slider__fadeOut\" : \"\"),\n    style: {\n      background: Ve ? \"rgba(0, 0, 0, \" + Ve + \")\" : void 0,\n      transitionTimingFunction: Ie,\n      transitionDuration: (ne ? 0 : Ae) + \"ms\",\n      animationDuration: Ae + \"ms\"\n    },\n    onAnimationEnd: ke\n  }), X && e.createElement(\"div\", {\n    className: \"PhotoView-Slider__BannerWrap\"\n  }, e.createElement(\"div\", {\n    className: \"PhotoView-Slider__Counter\"\n  }, me + 1, \" / \", we), e.createElement(\"div\", {\n    className: \"PhotoView-Slider__BannerRight\"\n  }, W && Re && W(Re), e.createElement(P, {\n    className: \"PhotoView-Slider__toolbarIcon\",\n    onClick: _e\n  }))), Se.map(function (n, t) {\n    var r = xe || 0 !== me ? pe.current - 1 + t : me + t;\n    return e.createElement(j, {\n      key: xe ? n.key + \"/\" + n.src + \"/\" + r : n.key,\n      item: n,\n      speed: Ae,\n      easing: Ie,\n      visible: O,\n      onReachMove: Ne,\n      onReachUp: We,\n      onPhotoTap: function onPhotoTap() {\n        return Ye(s);\n      },\n      onMaskTap: function onMaskTap() {\n        return Ye(v);\n      },\n      wrapClassName: R,\n      className: V,\n      style: {\n        left: (innerWidth + 20) * r + \"px\",\n        transform: \"translate3d(\" + ee + \"px, 0px, 0)\",\n        transition: ne || te ? void 0 : \"transform \" + He + \"ms \" + Le\n      },\n      loadingElement: A,\n      brokenElement: I,\n      onPhotoResize: Xe,\n      isActive: (ye && ye.key) === n.key,\n      expose: J\n    });\n  }), !w && X && e.createElement(e.Fragment, null, (xe || 0 !== me) && e.createElement(\"div\", {\n    className: \"PhotoView-Slider__ArrowLeft\",\n    onClick: function onClick() {\n      return Me(me - 1, !0);\n    }\n  }, e.createElement(_, null)), (xe || me + 1 < we) && e.createElement(\"div\", {\n    className: \"PhotoView-Slider__ArrowRight\",\n    onClick: function onClick() {\n      return Me(me + 1, !0);\n    }\n  }, e.createElement(M, null))), N && Re && e.createElement(\"div\", {\n    className: \"PhotoView-Slider__Overlay\"\n  }, N(Re)));\n}\n\nvar U = [\"children\", \"onIndexChange\", \"onVisibleChange\"],\n    G = {\n  images: [],\n  visible: !1,\n  index: 0\n};\n\nfunction J(t) {\n  var r = t.children,\n      i = t.onIndexChange,\n      o = t.onVisibleChange,\n      c = h(t, U),\n      u = g(G),\n      l = u[0],\n      s = u[1],\n      d = n(0),\n      v = l.images,\n      w = l.visible,\n      y = l.index,\n      x = m({\n    nextId: function nextId() {\n      return d.current += 1;\n    },\n    update: function update(e) {\n      var n = v.findIndex(function (n) {\n        return n.key === e.key;\n      });\n\n      if (n > -1) {\n        var t = v.slice();\n        return t.splice(n, 1, e), void s({\n          images: t\n        });\n      }\n\n      s(function (n) {\n        return {\n          images: n.images.concat(e)\n        };\n      });\n    },\n    remove: function remove(e) {\n      s(function (n) {\n        var t = n.images.filter(function (n) {\n          return n.key !== e;\n        });\n        return {\n          images: t,\n          index: Math.min(t.length - 1, y)\n        };\n      });\n    },\n    show: function show(e) {\n      var n = v.findIndex(function (n) {\n        return n.key === e;\n      });\n      s({\n        visible: !0,\n        index: n\n      }), o && o(!0, n, l);\n    }\n  }),\n      C = m({\n    close: function close() {\n      s({\n        visible: !1\n      }), o && o(!1, y, l);\n    },\n    changeIndex: function changeIndex(e) {\n      s({\n        index: e\n      }), i && i(e, l);\n    }\n  }),\n      b = a(function () {\n    return f({}, l, x);\n  }, [l, x]);\n  return e.createElement(p.Provider, {\n    value: b\n  }, r, e.createElement(K, f({\n    images: v,\n    visible: w,\n    index: y,\n    onIndexChange: C.changeIndex,\n    onClose: C.close\n  }, c)));\n}\n\nvar Q = function Q(e) {\n  var t,\n      r,\n      o = e.src,\n      c = e.render,\n      u = e.overlay,\n      v = e.width,\n      h = e.height,\n      g = e.triggers,\n      w = void 0 === g ? [\"onClick\"] : g,\n      y = e.children,\n      x = l(p),\n      C = (t = function t() {\n    return x.nextId();\n  }, (r = n({\n    sign: !1,\n    fn: void 0\n  }).current).sign || (r.sign = !0, r.fn = t()), r.fn),\n      b = n(null);\n  i(function () {\n    return function () {\n      x.remove(C);\n    };\n  }, []);\n  var E = m({\n    render: function render(e) {\n      return c && c(e);\n    },\n    show: function show(e, n) {\n      x.show(C), function (e, n) {\n        if (y) {\n          var t = y.props[e];\n          t && t(n);\n        }\n      }(e, n);\n    }\n  }),\n      k = a(function () {\n    var e = {};\n    return w.forEach(function (n) {\n      e[n] = E.show.bind(null, n);\n    }), e;\n  }, []);\n  return i(function () {\n    x.update({\n      key: C,\n      src: o,\n      originRef: b,\n      render: E.render,\n      overlay: u,\n      width: v,\n      height: h\n    });\n  }, [o]), y ? s.only(d(y, f({}, k, {\n    ref: b\n  }))) : null;\n};\n\nexport { J as PhotoProvider, K as PhotoSlider, Q as PhotoView };","map":{"version":3,"mappings":"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","names":["useMethods","fn","current","useRef","curr","undefined","Object","create","keys","forEach","key","call","useSetState","initialState","useReducer","state","action","createContext","isTouchDevice","window","limitNumber","value","min","max","Math","limitScale","scale","buffer","test","navigator","userAgent","useEffect","useLayoutEffect","useEventListener","type","options","latest","wrapper","evt","addEventListener","removeEventListener","SlidePortal","container","document","body","rest","createPortal","React","CloseIcon","props","width","height","viewBox","d","ArrowLeft","ArrowRight","PreventScroll","style","lastOverflow","overflow","getMultipleTouchPosition","touches","clientX","clientY","length","nextClientX","nextClientY","sqrt","computePositionEdge","position","size","innerSize","currentWidth","outOffset","closedEdge","getPositionOnMoveOrScale","x","y","toScale","offsetX","offsetY","innerWidth","innerHeight","closedEdgeX","centerClientX","centerClientY","lastCX","lastCY","getRotateSize","rotate","isVertical","getSuitableImageSize","naturalWidth","naturalHeight","currentHeight","autoWidth","autoHeight","pause","useDebounceCallback","callback","leading","maxWait","wait","a","callbackRef","prev","trailingTimeout","clearTrailing","clearTimeout","useCallback","args","now","Date","apply","last","offset","setTimeout","cancel","rebound","start","bound","easeOutMove","defaultSpeed","t","easeOutQuart","end","speed","easing","complete","distance","startTime","frameId","calcMove","time","raf","cancelAnimationFrame","requestAnimationFrame","initialRect","T","L","W","H","FIT","useMountedRef","mountedRef","Spinner","className","fill","opacity","Photo","src","loaded","broken","onPhotoLoad","loadingElement","brokenElement","restProps","onLoad","e","target","onError","alt","touched","maskTouched","CX","CY","lastX","lastY","lastScale","touchTime","touchLength","stopRaf","reach","PhotoBox","item","render","customWidth","c","s","customHeight","originRef","visible","wrapClassName","onPhotoTap","onMaskTap","onReachMove","onReachUp","onPhotoResize","isActive","expose","updateState","initialTouchRef","mounted","onScale","onRotate","handleMove","currentTouchLength","isStillX","abs","isStillY","currentReach","horizontalCloseEdge","initialTouchState","verticalCloseEdge","reachPosition","getReachType","updateRaf","singleTap","doubleTap","continuousClick","debounceTap","callbackX","callbackY","callbackS","slideToPosition","nextX","nextY","nextScale","X","spatial","Y","S","safeScale","touchedTime","beginEdgeX","beginX","beginEdgeY","beginY","moveTime","targetX","targetY","speedX","speedY","speedT","edgeX","edgeY","initialSpeed","v","lastTime","dt","direction","sign","f","ds","caf","scrollMove","isEdgeX","currentX","isEdgeY","currentY","resultX","resultY","handlePhotoTap","currentClientX","currentClientY","handleUp","handleStart","handleMaskStart","preventDefault","passive","touch","changedTouches","useIsomorphicLayoutEffect","updateEasing","realWidth","realHeight","realScale","execRef","lead","moveScale","useTargetScale","autoScale","useState","originRect","updateOriginRect","easingMode","updateEasingMode","initialTime","OK","handleToShape","currentShape","element","nodeType","getBoundingClientRect","top","left","tagName","getComputedStyle","objectFit","handleUpdateOrigin","useAnimationOrigin","centerWidth","centerHeight","miniMode","useAnimationPosition","isPause","currentScale","transitionCSS","attrs","onMouseDown","stopPropagation","button","onTouchStart","onWheel","deltaY","transform","transition","willChange","params","bg","lastBg","overlay","minimal","PhotoSlider","loop","i","speedFn","easingFn","photoClosable","maskClosable","maskOpacity","p","pullClosable","bannerVisible","overlayRender","toolbarRender","maskClassName","photoClassName","photoWrapClassName","images","index","controlledIndex","controlledIndexChange","onIndexChange","onClose","afterClose","portalContainer","innerIndex","updateInnerIndex","isControlled","hasOwnProperty","virtualIndexRef","imageLength","currentImage","enableLoop","handleRender","activeAnimation","initial","updater","forkedRef","modify","next","useMemo","useForkedVariable","modifyRealVisible","useAnimationVisible","realVisible","onAnimationEnd","close","changeIndex","nextIndex","currentIndex","limitIndex","nextVirtualIndex","singlePageWidth","closeable","handleResize","handleReachMove","originOffsetClientX","offsetClientX","handleReachHorizontalMove","handleReachVerticalMove","handleReachUp","offsetClientY","willClose","currentTranslateX","adjacentImages","concat","slice","useAdjacentImages","currentOverlayVisible","currentOpacity","overlayParams","overlayVisible","currentSpeed","currentEasing","slideSpeed","slideEasing","role","onClick","background","transitionTimingFunction","transitionDuration","animationDuration","map","PhotoProvider","children","onVisibleChange","uniqueIdRef","methods","nextId","update","imageItem","findIndex","n","nextImages","splice","remove","filter","show","PhotoContext","Provider","PhotoView","triggers","g","photoContext","useContext","eventName","eventFn","invokeChildrenFn","eventListeners","listener","bind","Children","only","cloneElement","ref"],"sources":["/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/hooks/useMethods.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/hooks/useSetState.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/photo-context.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/utils/isTouchDevice.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/utils/limitTarget.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/variables.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/hooks/useIsomorphicLayoutEffect.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/hooks/useEventListener.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/components/SlidePortal.tsx","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/components/CloseIcon.tsx","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/components/ArrowLeft.tsx","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/components/ArrowRight.tsx","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/components/PreventScroll.tsx","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/utils/getMultipleTouchPosition.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/utils/edgeHandle.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/utils/getPositionOnMoveOrScale.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/utils/getRotateSize.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/utils/getSuitableImageSize.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/hooks/useDebounceCallback.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/hooks/useScrollPosition.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/hooks/useAnimationOrigin.tsx","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/hooks/useMountedRef.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/components/Spinner.tsx","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/Photo.tsx","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/PhotoBox.tsx","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/hooks/useContinuousTap.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/hooks/useAnimationPosition.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/hooks/useTargetScale.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/PhotoSlider.tsx","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/hooks/useAnimationVisible.tsx","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/hooks/useForkedVariable.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/hooks/useAdjacentImages.ts","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/PhotoProvider.tsx","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/PhotoView.tsx","/Users/angxing/Desktop/T2ATesting/T2ATesting/node_modules/react-photo-view/src/hooks/useInitial.ts"],"sourcesContent":["import { useRef } from 'react';\n\n/**\n * Hook of persistent methods\n */\nexport default function useMethods<T extends Record<string, (...args: any[]) => any>>(fn: T) {\n  const { current } = useRef({\n    fn,\n    curr: undefined as T | undefined,\n  });\n  current.fn = fn;\n\n  if (!current.curr) {\n    const curr = Object.create(null);\n    Object.keys(fn).forEach((key) => {\n      curr[key] = (...args: unknown[]) => current.fn[key].call(current.fn, ...args);\n    });\n    current.curr = curr;\n  }\n\n  return current.curr as T;\n}\n","import { useReducer } from 'react';\n\nexport default function useSetState<S extends Record<string, any>>(initialState: S) {\n  return useReducer(\n    (state: S, action: Partial<S> | ((state: S) => Partial<S>)) => ({\n      ...state,\n      ...(typeof action === 'function' ? action(state) : action),\n    }),\n    initialState,\n  );\n}\n","import { createContext } from 'react';\nimport type { DataType } from './types';\n\nexport type UpdateItemType = (dataType: DataType) => void;\n\nexport interface PhotoContextType {\n  show: (key: number) => void;\n  update: UpdateItemType;\n  remove: (key: number) => void;\n  nextId: () => number;\n}\n\nexport default createContext<PhotoContextType>(undefined as unknown as PhotoContextType);\n","/**\n * 是否支持触摸设备\n */\nconst isTouchDevice = typeof window !== 'undefined' && 'ontouchstart' in window;\n\nexport default isTouchDevice;\n","import { maxScale, minScale } from '../variables';\n\nexport const limitNumber = (value: number, min: number, max: number) => {\n  return Math.max(Math.min(value, max), min);\n};\n\n/**\n * 限制最大/最小缩放\n */\nexport const limitScale = (scale: number, max: number = 0, buffer: number = 0) => {\n  return limitNumber(scale, minScale * (1 - buffer), Math.max(maxScale, max) * (1 + buffer));\n};\n","/**\n * 最大触摸时间\n */\nexport const maxTouchTime = 200;\n\n/**\n * 默认动画速度\n */\nexport const defaultSpeed = 400;\n\n/**\n * 默认动画函数\n */\nexport const defaultEasing = 'cubic-bezier(0.25, 0.8, 0.25, 1)';\n\n/**\n * 最大滑动切换图片距离\n */\nexport const maxMoveOffset = 40;\n\n/**\n * 图片的间隔\n */\nexport const horizontalOffset = 20;\n\n/**\n * 最小初始响应距离\n */\nexport const minStartTouchOffset = 20;\n\n/**\n * 默认背景透明度\n */\nexport const defaultOpacity = 1;\n\n/**\n * 最小缩放度\n */\nexport const minScale = 1;\n\n/**\n * 最大缩放度（若图片足够大，则会超出）\n */\nexport const maxScale = 6;\n\n/**\n * 最小长图模式比例\n */\nexport const longModeRatio = 3;\n\n/**\n * 缩放弹性缓冲\n */\nexport const scaleBuffer = 0.2;\n\n/**\n * 最大等待动画时间\n */\nexport const maxWaitAnimationTime = 250;\n","import { useEffect, useLayoutEffect } from 'react';\n\nconst isSSR = typeof window === 'undefined' || /ServerSideRendering/.test(navigator && navigator.userAgent);\n\nexport default isSSR ? useEffect : useLayoutEffect;\n","import { useEffect, useRef } from 'react';\n\nexport default function useEventListener<K extends keyof WindowEventMap>(\n  type: K | undefined,\n  fn: (evt: WindowEventMap[K]) => void,\n  options?: AddEventListenerOptions,\n) {\n  const latest = useRef(fn);\n  latest.current = fn;\n\n  useEffect(() => {\n    function wrapper(evt: WindowEventMap[K]) {\n      latest.current(evt);\n    }\n    if (type) {\n      window.addEventListener(type, wrapper, options);\n    }\n    return () => {\n      if (type) {\n        window.removeEventListener(type, wrapper);\n      }\n    };\n  }, [type]);\n}\n","import React from 'react';\nimport { createPortal } from 'react-dom';\nimport './SlidePortal.less';\n\nexport interface ISliderPortalProps extends React.HTMLAttributes<HTMLDivElement> {\n  container?: HTMLElement;\n}\n\nfunction SlidePortal({ container = document.body, ...rest }: ISliderPortalProps) {\n  return createPortal(<div {...rest} />, container);\n}\n\nexport default SlidePortal;\n","import React from 'react';\n\nfunction CloseIcon(props: React.HTMLAttributes<SVGElement>) {\n  return (\n    <svg width=\"44\" height=\"44\" viewBox=\"0 0 768 768\" {...props}>\n      <path d=\"M607.5 205.5l-178.5 178.5 178.5 178.5-45 45-178.5-178.5-178.5 178.5-45-45 178.5-178.5-178.5-178.5 45-45 178.5 178.5 178.5-178.5z\" />\n    </svg>\n  );\n}\n\nexport default CloseIcon;\n","import React from 'react';\n\nfunction ArrowLeft(props: React.HTMLAttributes<SVGElement>) {\n  return (\n    <svg width=\"44\" height=\"44\" viewBox=\"0 0 768 768\" {...props}>\n      <path d=\"M640.5 352.5v63h-390l178.5 180-45 45-256.5-256.5 256.5-256.5 45 45-178.5 180h390z\" />\n    </svg>\n  );\n}\n\nexport default ArrowLeft;\n","import React from 'react';\n\nfunction ArrowRight(props: React.HTMLAttributes<SVGElement>) {\n  return (\n    <svg width=\"44\" height=\"44\" viewBox=\"0 0 768 768\" {...props}>\n      <path d=\"M384 127.5l256.5 256.5-256.5 256.5-45-45 178.5-180h-390v-63h390l-178.5-180z\" />\n    </svg>\n  );\n}\n\nexport default ArrowRight;\n","import { useEffect } from 'react';\n\nexport default function PreventScroll() {\n  useEffect(() => {\n    const { style } = document.body;\n    const lastOverflow = style.overflow;\n    style.overflow = 'hidden';\n\n    return () => {\n      style.overflow = lastOverflow;\n    };\n  }, []);\n\n  return null;\n}\n","import type React from 'react';\n\n/**\n * 从 Touch 事件中获取两个触控中心位置\n */\nexport default function getMultipleTouchPosition(\n  evt: TouchEvent | React.TouchEvent,\n): [clientX: number, clientY: number, touchLength: number] {\n  const { clientX, clientY } = evt.touches[0];\n  if (evt.touches.length >= 2) {\n    const { clientX: nextClientX, clientY: nextClientY } = evt.touches[1];\n    return [\n      (clientX + nextClientX) / 2,\n      (clientY + nextClientY) / 2,\n      Math.sqrt((nextClientX - clientX) ** 2 + (nextClientY - clientY) ** 2),\n    ];\n  }\n  return [clientX, clientY, 0];\n}\n","import type { CloseEdgeType } from '../types';\nimport type { ReachType, TouchStartType } from '../types';\n\n/**\n * 获取接触边缘类型\n */\nexport const getReachType = (\n  initialTouchState: TouchStartType,\n  horizontalCloseEdge: CloseEdgeType,\n  verticalCloseEdge: CloseEdgeType,\n  reachPosition: ReachType,\n): ReachType => {\n  if ((horizontalCloseEdge && initialTouchState === 1) || reachPosition === 'x') {\n    return 'x';\n  } else if ((verticalCloseEdge && initialTouchState > 1) || reachPosition === 'y') {\n    return 'y';\n  }\n  return undefined;\n};\n\n/**\n * 计算接触边缘位置\n * @param position - x/y\n * @param scale\n * @param size - width/height\n * @param innerSize - innerWidth/innerHeight\n * @return [CloseEdgeType, position]\n */\nexport const computePositionEdge = (position: number, scale: number, size: number, innerSize: number) => {\n  const currentWidth = size * scale;\n  // 图片超出的宽度\n  const outOffset = (currentWidth - innerSize) / 2;\n  let closedEdge: CloseEdgeType = undefined;\n\n  let current = position;\n  if (currentWidth <= innerSize) {\n    closedEdge = 1;\n    current = 0;\n  } else if (position > 0 && outOffset - position <= 0) {\n    closedEdge = 2;\n    current = outOffset;\n  } else if (position < 0 && outOffset + position <= 0) {\n    closedEdge = 3;\n    current = -outOffset;\n  }\n\n  return [closedEdge, current] as const;\n};\n","import { longModeRatio } from '../variables';\nimport { computePositionEdge } from './edgeHandle';\n\n/**\n * 获取移动或缩放之后的中心点\n */\nexport default function getPositionOnMoveOrScale(\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  scale: number,\n  toScale: number,\n  clientX: number = innerWidth / 2,\n  clientY: number = innerHeight / 2,\n  offsetX: number = 0,\n  offsetY: number = 0,\n) {\n  // 是否接触边缘\n  const [closedEdgeX] = computePositionEdge(x, toScale, width, innerWidth);\n  const [closedEdgeY] = computePositionEdge(y, toScale, height, innerHeight);\n\n  const centerClientX = innerWidth / 2;\n  const centerClientY = innerHeight / 2;\n\n  // 坐标偏移\n  const lastPositionX = centerClientX + x;\n  const lastPositionY = centerClientY + y;\n\n  // 偏移位置\n  const originX = clientX - (clientX - lastPositionX) * (toScale / scale) - centerClientX;\n  const originY = clientY - (clientY - lastPositionY) * (toScale / scale) - centerClientY;\n  // 长图模式无左右反馈\n  const longModeEdge = height / width >= longModeRatio && width * toScale === innerWidth;\n  // 超出边缘距离减半\n  return {\n    x: originX + (longModeEdge ? 0 : closedEdgeX ? offsetX / 2 : offsetX),\n    y: originY + (closedEdgeY ? offsetY / 2 : offsetY),\n    lastCX: clientX,\n    lastCY: clientY,\n  };\n}\n","/**\n * 获取旋转后的宽高\n */\nexport default function getRotateSize(rotate: number, width: number, height: number) {\n  const isVertical = rotate % 180 !== 0;\n\n  // 若图片不是水平则调换属性\n  if (isVertical) {\n    return [height, width, isVertical] as const;\n  }\n\n  return [width, height, isVertical] as const;\n}\n","import { longModeRatio } from '../variables';\nimport getRotateSize from './getRotateSize';\n\n/**\n * 获取图片合适的大小\n */\nexport default function getSuitableImageSize(naturalWidth: number, naturalHeight: number, rotate: number) {\n  const [currentWidth, currentHeight, isVertical] = getRotateSize(rotate, innerWidth, innerHeight);\n\n  let y = 0;\n  let width = currentWidth;\n  let height = currentHeight;\n\n  // 自适应宽高\n  const autoWidth = (naturalWidth / naturalHeight) * currentHeight;\n  const autoHeight = (naturalHeight / naturalWidth) * currentWidth;\n\n  if (naturalWidth < currentWidth && naturalHeight < currentHeight) {\n    width = naturalWidth;\n    height = naturalHeight;\n  } else if (naturalWidth < currentWidth && naturalHeight >= currentHeight) {\n    width = autoWidth;\n  } else if (naturalWidth >= currentWidth && naturalHeight < currentHeight) {\n    height = autoHeight;\n  } else if (naturalWidth / naturalHeight > currentWidth / currentHeight) {\n    height = autoHeight;\n  }\n  // 长图模式\n  else if (naturalHeight / naturalWidth >= longModeRatio && !isVertical) {\n    height = autoHeight;\n    y = (height - currentHeight) / 2;\n  } else {\n    width = autoWidth;\n  }\n  return {\n    width,\n    height,\n    x: 0,\n    y,\n    pause: true,\n  };\n}\n","import { useCallback, useRef } from 'react';\n\ninterface DebounceCallback<CallbackArguments extends any[]> {\n  (...args: CallbackArguments): void;\n  cancel: () => void;\n}\n\nexport default function useDebounceCallback<CallbackArguments extends any[]>(\n  callback: (...args: CallbackArguments) => void,\n  {\n    leading = false,\n    maxWait,\n    wait = maxWait || 0,\n  }: {\n    leading?: boolean;\n    maxWait?: number;\n    wait?: number;\n  },\n): DebounceCallback<CallbackArguments> {\n  const callbackRef = useRef(callback);\n  callbackRef.current = callback;\n\n  const prev = useRef(0);\n  const trailingTimeout = useRef<ReturnType<typeof setTimeout>>();\n  const clearTrailing = () => trailingTimeout.current && clearTimeout(trailingTimeout.current);\n\n  const fn = useCallback(\n    (...args: CallbackArguments) => {\n      const now = Date.now();\n\n      function call() {\n        prev.current = now;\n        clearTrailing();\n        callbackRef.current.apply(null, args);\n      }\n      const last = prev.current;\n      const offset = now - last;\n      // leading\n      if (last === 0) {\n        if (leading) {\n          call();\n        }\n        prev.current = now;\n      }\n\n      // body\n      if (maxWait !== undefined) {\n        if (offset > maxWait) {\n          call();\n          return;\n        }\n      } else if (offset < wait) {\n        prev.current = now;\n      }\n\n      // trailing\n      clearTrailing();\n      trailingTimeout.current = setTimeout(() => {\n        call();\n        prev.current = 0;\n      }, wait);\n    },\n    [wait, maxWait, leading],\n  );\n  (fn as DebounceCallback<CallbackArguments>).cancel = clearTrailing;\n\n  return fn as DebounceCallback<CallbackArguments>;\n}\n","import { computePositionEdge } from '../utils/edgeHandle';\nimport getPositionOnMoveOrScale from '../utils/getPositionOnMoveOrScale';\nimport getRotateSize from '../utils/getRotateSize';\nimport { defaultSpeed, maxTouchTime } from '../variables';\nimport useMethods from './useMethods';\n\n// 触边运动反馈\nconst rebound = (start: number, bound: number, callback: (spatial: number) => boolean) =>\n  easeOutMove(\n    start,\n    bound,\n    callback,\n    defaultSpeed / 4,\n    (t) => t,\n    () => easeOutMove(bound, start, callback),\n  );\n\n/**\n * 物理滚动到具体位置\n */\nexport default function useScrollPosition<C extends (spatial: number) => boolean>(\n  callbackX: C,\n  callbackY: C,\n  callbackS: C,\n) {\n  const callback = useMethods({\n    X: (spatial: number) => callbackX(spatial),\n    Y: (spatial: number) => callbackY(spatial),\n    S: (spatial: number) => callbackS(spatial),\n  });\n\n  return (\n    x: number,\n    y: number,\n    lastX: number,\n    lastY: number,\n    width: number,\n    height: number,\n    scale: number,\n    safeScale: number,\n    lastScale: number,\n    rotate: number,\n    touchedTime: number,\n  ) => {\n    const [currentWidth, currentHeight] = getRotateSize(rotate, width, height);\n    // 开始状态下边缘触发状态\n    const [beginEdgeX, beginX] = computePositionEdge(x, safeScale, currentWidth, innerWidth);\n    const [beginEdgeY, beginY] = computePositionEdge(y, safeScale, currentHeight, innerHeight);\n    const moveTime = Date.now() - touchedTime;\n\n    // 时间过长、超出安全范围的情况下不执行滚动逻辑，恢复安全范围\n    if (moveTime >= maxTouchTime || safeScale != scale || Math.abs(lastScale - scale) > 1) {\n      // 计算中心缩放点\n      const { x: nextX, y: nextY } = getPositionOnMoveOrScale(x, y, width, height, scale, safeScale);\n      const targetX = beginEdgeX ? beginX : nextX !== x ? nextX : null;\n      const targetY = beginEdgeY ? beginY : nextY !== y ? nextY : null;\n\n      if (targetX !== null) {\n        easeOutMove(x, targetX, callback.X);\n      }\n      if (targetY !== null) {\n        easeOutMove(y, targetY, callback.Y);\n      }\n      if (safeScale != scale) {\n        easeOutMove(scale, safeScale, callback.S);\n      }\n      return;\n    }\n\n    // 初始速度\n    const speedX = (x - lastX) / moveTime;\n    const speedY = (y - lastY) / moveTime;\n    const speedT = Math.sqrt(speedX ** 2 + speedY ** 2);\n    // 是否接触到边缘\n    let edgeX = false;\n    let edgeY = false;\n\n    scrollMove(speedT, (spatial) => {\n      const nextX = x + spatial * (speedX / speedT);\n      const nextY = y + spatial * (speedY / speedT);\n\n      const [isEdgeX, currentX] = computePositionEdge(nextX, scale, currentWidth, innerWidth);\n      const [isEdgeY, currentY] = computePositionEdge(nextY, scale, currentHeight, innerHeight);\n\n      if (isEdgeX && !edgeX) {\n        edgeX = true;\n        if (beginEdgeX) {\n          easeOutMove(nextX, currentX, callback.X);\n        } else {\n          rebound(currentX, nextX + (nextX - currentX), callback.X);\n        }\n      }\n\n      if (isEdgeY && !edgeY) {\n        edgeY = true;\n        if (beginEdgeY) {\n          easeOutMove(nextY, currentY, callback.Y);\n        } else {\n          rebound(currentY, nextY + (nextY - currentY), callback.Y);\n        }\n      }\n      // 同时接触边缘的情况下停止滚动\n      if (edgeX && edgeY) {\n        return false;\n      }\n\n      const resultX = edgeX || callback.X(currentX);\n      const resultY = edgeY || callback.Y(currentY);\n      return resultX && resultY;\n    });\n  };\n}\n\n// 加速度\nconst acceleration = -0.001;\n// 阻力\nconst resistance = 0.0002;\n\n/**\n * 通过速度滚动到停止\n */\nfunction scrollMove(initialSpeed: number, callback: (spatial: number) => boolean) {\n  let v = initialSpeed;\n  let s = 0;\n  let lastTime: number | undefined = undefined;\n  let frameId = 0;\n\n  const calcMove = (now: number) => {\n    if (!lastTime) {\n      lastTime = now;\n    }\n    const dt = now - lastTime;\n    const direction = Math.sign(initialSpeed);\n    const a = direction * acceleration;\n    const f = Math.sign(-v) * v ** 2 * resistance;\n    const ds = v * dt + ((a + f) * dt ** 2) / 2;\n    v = v + (a + f) * dt;\n\n    s = s + ds;\n    // move to s\n    lastTime = now;\n\n    if (direction * v <= 0) {\n      caf();\n      return;\n    }\n\n    if (callback(s)) {\n      raf();\n      return;\n    }\n    caf();\n  };\n  raf();\n\n  function raf() {\n    frameId = requestAnimationFrame(calcMove);\n  }\n  function caf() {\n    cancelAnimationFrame(frameId);\n  }\n}\n\n/**\n * 缓动函数\n */\nconst easeOutQuart = (x: number) => 1 - (1 - x) ** 4;\n\n/**\n * 缓动回调\n */\nfunction easeOutMove(\n  start: number,\n  end: number,\n  callback: (spatial: number) => boolean,\n  speed = defaultSpeed,\n  easing = easeOutQuart,\n  complete?: () => void,\n) {\n  const distance = end - start;\n  if (distance === 0) {\n    return;\n  }\n\n  const startTime = Date.now();\n  let frameId = 0;\n\n  const calcMove = () => {\n    const time = Math.min(1, (Date.now() - startTime) / speed);\n    const result = callback(start + easing(time) * distance);\n\n    if (result && time < 1) {\n      raf();\n      return;\n    }\n    cancelAnimationFrame(frameId);\n    if (time >= 1 && complete) {\n      complete();\n    }\n  };\n  raf();\n\n  function raf() {\n    frameId = requestAnimationFrame(calcMove);\n  }\n}\n","import type { Dispatch, MutableRefObject, SetStateAction } from 'react';\nimport { useState, useEffect, useRef } from 'react';\nimport type { EasingMode, OriginRectType } from '../types';\nimport useMethods from './useMethods';\nimport { maxWaitAnimationTime } from '../variables';\n\nconst initialRect: OriginRectType = {\n  T: 0,\n  L: 0,\n  W: 0,\n  H: 0,\n  // 图像填充方式\n  FIT: undefined,\n};\n\nexport default function useAnimationOrigin(\n  visible: boolean | undefined,\n  originRef: MutableRefObject<HTMLElement | null> | undefined,\n  loaded: boolean,\n  speed: number,\n  updateEasing: (pause: boolean) => void,\n): [\n  // 动画状态\n  easingMode: EasingMode,\n  originRect: OriginRectType,\n] {\n  const [originRect, updateOriginRect] = useState(initialRect);\n  // 动画状态\n  const [easingMode, updateEasingMode] = useState<EasingMode>(0);\n  const initialTime = useRef<number>();\n\n  const fn = useMethods({\n    OK: () => visible && updateEasingMode(4),\n  });\n\n  useEffect(() => {\n    // 记录初始打开的时间\n    if (!initialTime.current) {\n      initialTime.current = Date.now();\n    }\n    if (!loaded) {\n      return;\n    }\n    handleUpdateOrigin(originRef, updateOriginRect);\n    // 打开动画处理\n    if (visible) {\n      // 小于最大允许动画时间，则执行缩放动画\n      if (Date.now() - initialTime.current < maxWaitAnimationTime) {\n        updateEasingMode(1);\n        // 延时执行动画，保持 transition 生效\n        requestAnimationFrame(() => {\n          updateEasingMode(2);\n          requestAnimationFrame(() => handleToShape(3));\n        });\n        setTimeout(fn.OK, speed);\n        return;\n      }\n      // 超出则不执行\n      updateEasingMode(4);\n      return;\n    }\n    // 关闭动画处理\n    handleToShape(5);\n  }, [visible, loaded]);\n\n  function handleToShape(currentShape: EasingMode) {\n    updateEasing(false);\n    updateEasingMode(currentShape);\n  }\n\n  return [easingMode, originRect];\n}\n\n/**\n * 更新缩略图位置信息\n */\nfunction handleUpdateOrigin(\n  originRef: MutableRefObject<HTMLElement | null> | undefined,\n  updateOriginRect: Dispatch<SetStateAction<typeof initialRect>>,\n) {\n  const element = originRef && originRef.current;\n\n  if (element && element.nodeType === 1) {\n    // 获取触发时节点位置\n    const { top, left, width, height } = element.getBoundingClientRect();\n    const isImage = element.tagName === 'IMG';\n    updateOriginRect({\n      T: top,\n      L: left,\n      W: width,\n      H: height,\n      FIT: isImage ? (getComputedStyle(element).objectFit as 'contain' | 'cover' | 'fill' | undefined) : undefined,\n    });\n  }\n}\n","import { useEffect, useRef } from 'react';\n\nconst useMountedRef = () => {\n  const mountedRef = useRef(false);\n  useEffect(() => {\n    mountedRef.current = true;\n    return () => {\n      mountedRef.current = false;\n    };\n  }, []);\n  return mountedRef;\n};\n\nexport default useMountedRef;\n","import React from 'react';\nimport './Spinner.less';\n\nfunction Spinner({ className, ...props }: React.HTMLAttributes<HTMLElement>) {\n  return (\n    <div className={`PhotoView__Spinner ${className}`} {...props}>\n      <svg viewBox=\"0 0 32 32\" width=\"36\" height=\"36\" fill=\"white\">\n        <path opacity=\".25\" d=\"M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4\" />\n        <path d=\"M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z\" />\n      </svg>\n    </div>\n  );\n}\n\nexport default Spinner;\n","import React from 'react';\nimport Spinner from './components/Spinner';\nimport useMountedRef from './hooks/useMountedRef';\nimport type { BrokenElementParams } from './types';\nimport './Photo.less';\n\nexport interface IPhotoLoadedParams {\n  loaded?: boolean;\n  naturalWidth?: number;\n  naturalHeight?: number;\n  broken?: boolean;\n}\n\nexport interface IPhotoProps extends React.HTMLAttributes<HTMLElement> {\n  src: string;\n  loaded: boolean;\n  broken: boolean;\n  onPhotoLoad: (params: IPhotoLoadedParams) => void;\n  loadingElement?: JSX.Element;\n  brokenElement?: JSX.Element | ((photoProps: BrokenElementParams) => JSX.Element);\n}\n\nexport default function Photo({\n  src,\n  loaded,\n  broken,\n  className,\n  onPhotoLoad,\n  loadingElement,\n  brokenElement,\n  ...restProps\n}: IPhotoProps) {\n  const mountedRef = useMountedRef();\n\n  function handleImageLoaded(e: React.SyntheticEvent<HTMLImageElement>) {\n    const { naturalWidth, naturalHeight } = e.target as HTMLImageElement;\n    if (mountedRef.current) {\n      onPhotoLoad({\n        loaded: true,\n        naturalWidth,\n        naturalHeight,\n      });\n    }\n  }\n\n  function handleImageBroken() {\n    if (mountedRef.current) {\n      onPhotoLoad({\n        broken: true,\n      });\n    }\n  }\n\n  if (src && !broken) {\n    return (\n      <>\n        <img\n          className={`PhotoView__Photo${className ? ` ${className}` : ''}`}\n          src={src}\n          onLoad={handleImageLoaded}\n          onError={handleImageBroken}\n          alt=\"\"\n          {...restProps}\n        />\n        {!loaded &&\n          (<span className=\"PhotoView__icon\">{loadingElement}</span> || <Spinner className=\"PhotoView__icon\" />)}\n      </>\n    );\n  }\n\n  if (brokenElement) {\n    return (\n      <span className=\"PhotoView__icon\">\n        {typeof brokenElement === 'function' ? brokenElement({ src }) : brokenElement}\n      </span>\n    );\n  }\n\n  return null;\n}\n","import React, { useRef } from 'react';\nimport isTouchDevice from './utils/isTouchDevice';\nimport getMultipleTouchPosition from './utils/getMultipleTouchPosition';\nimport getPositionOnMoveOrScale from './utils/getPositionOnMoveOrScale';\nimport { getReachType, computePositionEdge } from './utils/edgeHandle';\nimport getRotateSize from './utils/getRotateSize';\nimport { limitScale } from './utils/limitTarget';\nimport getSuitableImageSize from './utils/getSuitableImageSize';\nimport useIsomorphicLayoutEffect from './hooks/useIsomorphicLayoutEffect';\nimport { minStartTouchOffset, scaleBuffer } from './variables';\nimport type {\n  DataType,\n  ReachMoveFunction,\n  ReachFunction,\n  PhotoTapFunction,\n  BrokenElementParams,\n  ExposedProperties,\n} from './types';\nimport type { ReachType, TouchStartType } from './types';\nimport useSetState from './hooks/useSetState';\nimport useMethods from './hooks/useMethods';\nimport useDebounceCallback from './hooks/useDebounceCallback';\nimport useEventListener from './hooks/useEventListener';\nimport useContinuousTap from './hooks/useContinuousTap';\nimport useScrollPosition from './hooks/useScrollPosition';\nimport useAnimationPosition from './hooks/useAnimationPosition';\nimport useMountedRef from './hooks/useMountedRef';\nimport type { IPhotoLoadedParams } from './Photo';\nimport Photo from './Photo';\nimport './PhotoBox.less';\n\nexport interface PhotoBoxProps {\n  // 图片信息\n  item: DataType;\n  // 是否可见\n  visible: boolean;\n  // 动画时间\n  speed: number;\n  // 动画函数\n  easing: string;\n  // 容器类名\n  wrapClassName?: string;\n  // 图片类名\n  className?: string;\n  // style\n  style?: object;\n  // 自定义 loading\n  loadingElement?: JSX.Element;\n  // 加载失败 Element\n  brokenElement?: JSX.Element | ((photoProps: BrokenElementParams) => JSX.Element);\n\n  // Photo 点击事件\n  onPhotoTap: PhotoTapFunction;\n  // Mask 点击事件\n  onMaskTap: PhotoTapFunction;\n  // 到达边缘滑动事件\n  onReachMove: ReachMoveFunction;\n  // 触摸解除事件\n  onReachUp: ReachFunction;\n  // Resize 事件\n  onPhotoResize: () => void;\n  // 向父组件导出属性\n  expose: (state: ExposedProperties) => void;\n  // 是否在当前操作中\n  isActive: boolean;\n}\n\nconst initialState = {\n  // 真实宽度\n  naturalWidth: undefined as number | undefined,\n  // 真实高度\n  naturalHeight: undefined as number | undefined,\n  // 宽度\n  width: undefined as number | undefined,\n  // 高度\n  height: undefined as number | undefined,\n  // 加载成功状态\n  loaded: undefined as boolean | undefined,\n  // 破碎状态\n  broken: false,\n\n  // 图片 X 偏移量\n  x: 0,\n  // 图片 y 偏移量\n  y: 0,\n  // 图片处于触摸的状态\n  touched: false,\n  // 背景处于触摸状态\n  maskTouched: false,\n  // 旋转状态\n  rotate: 0,\n  // 放大缩小\n  scale: 1,\n\n  // 触摸开始时 x 原始坐标\n  CX: 0,\n  // 触摸开始时 y 原始坐标\n  CY: 0,\n\n  // 触摸开始时图片 x 偏移量\n  lastX: 0,\n  // 触摸开始时图片 y 偏移量\n  lastY: 0,\n  // 上一个触摸状态 x 原始坐标\n  lastCX: 0,\n  // 上一个触摸状态 y 原始坐标\n  lastCY: 0,\n  // 上一个触摸状态的 scale\n  lastScale: 1,\n\n  // 触摸开始时时间\n  touchTime: 0,\n  // 多指触控间距\n  touchLength: 0,\n  // 是否暂停 transition\n  pause: true,\n  // 停止 Raf\n  stopRaf: true,\n  // 当前边缘触发状态\n  reach: undefined as ReachType,\n};\n\nexport default function PhotoBox({\n  item: { src, render, width: customWidth = 0, height: customHeight = 0, originRef },\n  visible,\n  speed,\n  easing,\n  wrapClassName,\n  className,\n  style,\n  loadingElement,\n  brokenElement,\n\n  onPhotoTap,\n  onMaskTap,\n  onReachMove,\n  onReachUp,\n  onPhotoResize,\n  isActive,\n  expose,\n}: PhotoBoxProps) {\n  const [state, updateState] = useSetState(initialState);\n  const initialTouchRef = useRef<TouchStartType>(0);\n  const mounted = useMountedRef();\n\n  const {\n    naturalWidth = customWidth,\n    naturalHeight = customHeight,\n    width = customWidth,\n    height = customHeight,\n    loaded = !src,\n    broken,\n    x,\n    y,\n    touched,\n    stopRaf,\n    maskTouched,\n    rotate,\n    scale,\n    CX,\n    CY,\n    lastX,\n    lastY,\n    lastCX,\n    lastCY,\n    lastScale,\n    touchTime,\n    touchLength,\n    pause,\n    reach,\n  } = state;\n\n  const fn = useMethods({\n    onScale: (current: number) => onScale(limitScale(current)),\n    onRotate(current: number) {\n      if (rotate !== current) {\n        expose({ rotate: current });\n        updateState({ rotate: current, ...getSuitableImageSize(naturalWidth, naturalHeight, current) });\n      }\n    },\n  });\n\n  // 默认为屏幕中心缩放\n  function onScale(current: number, clientX?: number, clientY?: number) {\n    if (scale !== current) {\n      expose({ scale: current });\n      updateState({\n        scale: current,\n        ...getPositionOnMoveOrScale(x, y, width, height, scale, current, clientX, clientY),\n        ...(current <= 1 && { x: 0, y: 0 }),\n      });\n    }\n  }\n\n  const handleMove = useDebounceCallback(\n    (nextClientX: number, nextClientY: number, currentTouchLength: number = 0) => {\n      if ((touched || maskTouched) && isActive) {\n        // 通过旋转调换宽高\n        const [currentWidth, currentHeight] = getRotateSize(rotate, width, height);\n        // 单指最小缩放下，以初始移动距离来判断意图\n        if (currentTouchLength === 0 && initialTouchRef.current === 0) {\n          const isStillX = Math.abs(nextClientX - CX) <= minStartTouchOffset;\n          const isStillY = Math.abs(nextClientY - CY) <= minStartTouchOffset;\n          // 初始移动距离不足\n          if (isStillX && isStillY) {\n            // 方向记录上次移动距离，以便平滑过渡\n            updateState({ lastCX: nextClientX, lastCY: nextClientY });\n            return;\n          }\n          // 设置响应状态\n          initialTouchRef.current = !isStillX ? 1 : nextClientY > CY ? 3 : 2;\n        }\n\n        const offsetX = nextClientX - lastCX;\n        const offsetY = nextClientY - lastCY;\n        // 边缘触发状态\n        let currentReach: ReachType = undefined;\n        if (currentTouchLength === 0) {\n          // 边缘超出状态\n          const [horizontalCloseEdge] = computePositionEdge(offsetX + lastX, scale, currentWidth, innerWidth);\n          const [verticalCloseEdge] = computePositionEdge(offsetY + lastY, scale, currentHeight, innerHeight);\n          // 边缘触发检测\n          currentReach = getReachType(initialTouchRef.current, horizontalCloseEdge, verticalCloseEdge, reach);\n\n          // 接触边缘\n          if (currentReach !== undefined) {\n            onReachMove(currentReach, nextClientX, nextClientY, scale);\n          }\n        }\n        // 横向边缘触发、背景触发禁用当前滑动\n        if (currentReach === 'x' || maskTouched) {\n          updateState({ reach: 'x' });\n          return;\n        }\n        // 目标倍数\n        const toScale = limitScale(\n          scale + ((currentTouchLength - touchLength) / 100 / 2) * scale,\n          naturalWidth / width,\n          scaleBuffer,\n        );\n        // 导出变量\n        expose({ scale: toScale });\n        updateState({\n          touchLength: currentTouchLength,\n          reach: currentReach,\n          scale: toScale,\n          ...getPositionOnMoveOrScale(x, y, width, height, scale, toScale, nextClientX, nextClientY, offsetX, offsetY),\n        });\n      }\n    },\n    {\n      maxWait: 8,\n    },\n  );\n\n  function updateRaf(position: { x?: number; y?: number }) {\n    if (stopRaf || touched) {\n      return false;\n    }\n    if (mounted.current) {\n      // 下拉关闭时可以有动画\n      updateState({ ...position, pause: visible });\n    }\n    return mounted.current;\n  }\n\n  const slideToPosition = useScrollPosition(\n    (nextX) => updateRaf({ x: nextX }),\n    (nextY) => updateRaf({ y: nextY }),\n    (nextScale) => {\n      if (mounted.current) {\n        expose({ scale: nextScale });\n        updateState({ scale: nextScale });\n      }\n      return !touched && mounted.current;\n    },\n  );\n\n  const handlePhotoTap = useContinuousTap(onPhotoTap, (currentClientX: number, currentClientY: number) => {\n    if (!reach) {\n      // 若图片足够大，则放大适应的倍数\n      const endScale = scale !== 1 ? 1 : Math.max(2, naturalWidth / width);\n      onScale(endScale, currentClientX, currentClientY);\n    }\n  });\n\n  function handleUp(nextClientX: number, nextClientY: number) {\n    // 重置响应状态\n    initialTouchRef.current = 0;\n    if ((touched || maskTouched) && isActive) {\n      updateState({\n        touched: false,\n        maskTouched: false,\n        pause: false,\n        stopRaf: false,\n        reach: undefined,\n      });\n      const safeScale = limitScale(scale, naturalWidth / width);\n      // Go\n      slideToPosition(x, y, lastX, lastY, width, height, scale, safeScale, lastScale, rotate, touchTime);\n\n      onReachUp(nextClientX, nextClientY);\n      // 触发 Tap 事件\n      if (CX === nextClientX && CY === nextClientY) {\n        if (touched) {\n          handlePhotoTap(nextClientX, nextClientY);\n          return;\n        }\n        if (maskTouched) {\n          onMaskTap(nextClientX, nextClientY);\n        }\n      }\n    }\n  }\n\n  useEventListener(isTouchDevice ? undefined : 'mousemove', (e) => {\n    e.preventDefault();\n    handleMove(e.clientX, e.clientY);\n  });\n  useEventListener(isTouchDevice ? undefined : 'mouseup', (e) => {\n    handleUp(e.clientX, e.clientY);\n  });\n  useEventListener(\n    isTouchDevice ? 'touchmove' : undefined,\n    (e) => {\n      e.preventDefault();\n      const position = getMultipleTouchPosition(e);\n      handleMove(...position);\n    },\n    { passive: false },\n  );\n  useEventListener(\n    isTouchDevice ? 'touchend' : undefined,\n    ({ changedTouches }) => {\n      const touch = changedTouches[0];\n      handleUp(touch.clientX, touch.clientY);\n    },\n    { passive: false },\n  );\n  useEventListener(\n    'resize',\n    useDebounceCallback(\n      () => {\n        if (loaded && !touched) {\n          updateState(getSuitableImageSize(naturalWidth, naturalHeight, rotate));\n          onPhotoResize();\n        }\n      },\n      { maxWait: 8 },\n    ),\n  );\n\n  useIsomorphicLayoutEffect(() => {\n    if (isActive) {\n      expose({ scale, rotate, ...fn });\n    }\n  }, [isActive]);\n\n  function handlePhotoLoad(params: IPhotoLoadedParams) {\n    updateState({\n      ...params,\n      ...(params.loaded && getSuitableImageSize(params.naturalWidth || 0, params.naturalHeight || 0, rotate)),\n    });\n  }\n\n  function handleStart(currentClientX: number, currentClientY: number, currentTouchLength: number = 0) {\n    updateState({\n      touched: true,\n      CX: currentClientX,\n      CY: currentClientY,\n      lastCX: currentClientX,\n      lastCY: currentClientY,\n      lastX: x,\n      lastY: y,\n      lastScale: scale,\n      touchLength: currentTouchLength,\n      touchTime: Date.now(),\n    });\n  }\n\n  function handleWheel(e: React.WheelEvent) {\n    if (!reach) {\n      // 限制最大倍数和最小倍数\n      const toScale = limitScale(scale - e.deltaY / 100 / 2, naturalWidth / width);\n      updateState({ stopRaf: true });\n      onScale(toScale, e.clientX, e.clientY);\n    }\n  }\n\n  function handleMaskStart(e: { clientX: number; clientY: number }) {\n    updateState({\n      maskTouched: true,\n      CX: e.clientX,\n      CY: e.clientY,\n      lastX: x,\n      lastY: y,\n    });\n  }\n\n  function handleTouchStart(e: React.TouchEvent) {\n    e.stopPropagation();\n    handleStart(...getMultipleTouchPosition(e));\n  }\n\n  function handleMouseDown(e: React.MouseEvent) {\n    e.stopPropagation();\n    if (e.button === 0) {\n      handleStart(e.clientX, e.clientY, 0);\n    }\n  }\n\n  // 计算位置\n  const [translateX, translateY, currentWidth, currentHeight, currentScale, opacity, easingMode, FIT] =\n    useAnimationPosition(visible, originRef, loaded, x, y, width, height, scale, speed, (isPause: boolean) =>\n      updateState({ pause: isPause }),\n    );\n  // 图片 objectFit 渐变时间\n  const transitionLayoutTime = easingMode < 4 ? speed / 2 : easingMode > 4 ? speed : 0;\n  const transitionCSS = `transform ${speed}ms ${easing}`;\n\n  const attrs = {\n    className,\n    onMouseDown: isTouchDevice ? undefined : handleMouseDown,\n    onTouchStart: isTouchDevice ? handleTouchStart : undefined,\n    onWheel: handleWheel,\n    style: {\n      width: currentWidth,\n      height: currentHeight,\n      opacity,\n      objectFit: easingMode === 4 ? undefined : FIT,\n      transform: rotate ? `rotate(${rotate}deg)` : undefined,\n      transition:\n        // 初始状态无渐变\n        easingMode > 2\n          ? `${transitionCSS}, opacity ${speed}ms ease, height ${transitionLayoutTime}ms ${easing}`\n          : undefined,\n    },\n  };\n\n  return (\n    <div\n      className={`PhotoView__PhotoWrap${wrapClassName ? ` ${wrapClassName}` : ''}`}\n      style={style}\n      onMouseDown={!isTouchDevice && isActive ? handleMaskStart : undefined}\n      onTouchStart={isTouchDevice && isActive ? (e) => handleMaskStart(e.touches[0]) : undefined}\n    >\n      <div\n        className=\"PhotoView__PhotoBox\"\n        style={{\n          transform: `matrix(${currentScale}, 0, 0, ${currentScale}, ${translateX}, ${translateY})`,\n          transition: touched || pause ? undefined : transitionCSS,\n          willChange: isActive ? 'transform' : undefined,\n        }}\n      >\n        {src ? (\n          <Photo\n            src={src}\n            loaded={loaded}\n            broken={broken}\n            {...attrs}\n            onPhotoLoad={handlePhotoLoad}\n            loadingElement={loadingElement}\n            brokenElement={brokenElement}\n          />\n        ) : (\n          render && render({ attrs, scale: currentScale, rotate })\n        )}\n      </div>\n    </div>\n  );\n}\n","import { useRef } from 'react';\nimport useDebounceCallback from './useDebounceCallback';\n\nexport type TapFuncType<T> = (...args: T[]) => void;\n\n/**\n * 单击和双击事件处理\n * @param singleTap - 单击事件\n * @param doubleTap - 双击事件\n * @return invokeTap\n */\nexport default function useContinuousTap<T>(singleTap: TapFuncType<T>, doubleTap: TapFuncType<T>): TapFuncType<T> {\n  // 当前连续点击次数\n  const continuousClick = useRef(0);\n\n  const debounceTap = useDebounceCallback(\n    (...args) => {\n      continuousClick.current = 0;\n      singleTap(...args);\n    },\n    {\n      wait: 300,\n    },\n  );\n\n  return function invokeTap(...args) {\n    continuousClick.current += 1;\n    debounceTap(...args);\n    // 双击\n    if (continuousClick.current >= 2) {\n      debounceTap.cancel();\n      continuousClick.current = 0;\n      doubleTap(...args);\n    }\n  };\n}\n","import type { MutableRefObject } from 'react';\nimport useAnimationOrigin from './useAnimationOrigin';\nimport useTargetScale from './useTargetScale';\n\nexport default function useAnimationPosition(\n  visible: boolean | undefined,\n  originRef: MutableRefObject<HTMLElement | null> | undefined,\n  loaded: boolean,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  scale: number,\n  speed: number,\n  updateEasing: (pause: boolean) => void,\n) {\n  // 延迟更新 width/height\n  const [autoWidth, autoHeight, autoScale] = useTargetScale(width, height, scale, speed, updateEasing);\n  // 动画源处理\n  const [easingMode, originRect] = useAnimationOrigin(visible, originRef, loaded, speed, updateEasing);\n\n  // 计算动画位置\n  const { T, L, W, H, FIT } = originRect;\n  // 偏移量，x: 0, y: 0 居中为初始\n  const centerWidth = innerWidth / 2;\n  const centerHeight = innerHeight / 2;\n  const offsetX = centerWidth - (width * scale) / 2;\n  const offsetY = centerHeight - (height * scale) / 2;\n  // 缩略图状态\n  const miniMode = easingMode < 3 || easingMode > 4;\n  // 有缩略图时，则为缩略图的位置，否则居中\n  const translateX = miniMode ? (W ? L : centerWidth) : x + offsetX;\n  const translateY = miniMode ? (W ? T : centerHeight) : y + offsetY;\n\n  // 最小值缩放\n  const minScale = W / (width * scale) || 0.01;\n\n  // 适应 objectFit 保持缩略图宽高比\n  const currentHeight = miniMode && FIT ? autoWidth * (H / W) : autoHeight;\n  // 初始加载情况无缩放\n  const currentScale = easingMode === 0 ? autoScale : miniMode ? minScale : autoScale;\n  const opacity = miniMode ? (FIT ? 1 : 0) : 1;\n\n  return [translateX, translateY, autoWidth, currentHeight, currentScale, opacity, easingMode, FIT] as const;\n}\n","import { useRef } from 'react';\nimport useSetState from './useSetState';\nimport useIsomorphicLayoutEffect from './useIsomorphicLayoutEffect';\nimport useDebounceCallback from './useDebounceCallback';\n\n/**\n * 目标缩放延迟处理\n */\nexport default function useTargetScale(\n  realWidth: number,\n  realHeight: number,\n  realScale: number,\n  speed: number,\n  updateEasing: (pause: boolean) => void,\n) {\n  const execRef = useRef(false);\n\n  const [{ lead, scale }, updateState] = useSetState({ lead: true, scale: realScale });\n\n  const moveScale = useDebounceCallback(\n    async (current: number) => {\n      updateEasing(true);\n      updateState({ lead: false, scale: current });\n    },\n    { wait: speed },\n  );\n\n  useIsomorphicLayoutEffect(() => {\n    if (!execRef.current) {\n      execRef.current = true;\n      return;\n    }\n    updateEasing(false);\n    updateState({ lead: true });\n\n    moveScale(realScale);\n  }, [realScale]);\n\n  // 运动开始\n  if (lead) {\n    return [realWidth * scale, realHeight * scale, realScale / scale] as const;\n  }\n\n  // 运动结束\n  return [realWidth * realScale, realHeight * realScale, 1] as const;\n}\n","import React, { useRef, useState } from 'react';\nimport type { DataType, PhotoProviderBase, OverlayRenderProps } from './types';\nimport type { ReachType } from './types';\nimport { defaultEasing, defaultSpeed, defaultOpacity, horizontalOffset, maxMoveOffset } from './variables';\nimport isTouchDevice from './utils/isTouchDevice';\nimport { limitNumber } from './utils/limitTarget';\nimport useIsomorphicLayoutEffect from './hooks/useIsomorphicLayoutEffect';\nimport useAdjacentImages from './hooks/useAdjacentImages';\nimport useSetState from './hooks/useSetState';\nimport useEventListener from './hooks/useEventListener';\nimport useAnimationVisible from './hooks/useAnimationVisible';\nimport useMethods from './hooks/useMethods';\nimport SlidePortal from './components/SlidePortal';\nimport CloseIcon from './components/CloseIcon';\nimport ArrowLeft from './components/ArrowLeft';\nimport ArrowRight from './components/ArrowRight';\nimport PreventScroll from './components/PreventScroll';\nimport PhotoBox from './PhotoBox';\nimport './PhotoSlider.less';\n\nexport interface IPhotoSliderProps extends PhotoProviderBase {\n  // 图片列表\n  images: DataType[];\n  // 图片当前索引\n  index?: number;\n  // 索引改变回调\n  onIndexChange?: (index: number) => void;\n  // 可见\n  visible: boolean;\n  // 关闭回调\n  onClose: (evt?: React.MouseEvent | React.TouchEvent) => void;\n  // 关闭动画结束后回调\n  afterClose?: () => void;\n}\n\ntype PhotoSliderState = {\n  // 偏移量\n  x: number;\n  // 图片处于触摸的状态\n  touched: boolean;\n  // 是否暂停 transition\n  pause: boolean;\n  // Reach 开始时 x 坐标\n  lastCX: number | undefined;\n  // Reach 开始时 y 坐标\n  lastCY: number | undefined;\n  // 背景透明度\n  bg: number | null | undefined;\n  // 上次关闭的背景透明度\n  lastBg: number | null | undefined;\n  // 是否显示 overlay\n  overlay: boolean;\n  // 是否为最小状态，可下拉关闭\n  minimal: boolean;\n  // 缩放\n  scale: number;\n  // 旋转\n  rotate: number;\n  // 缩放回调\n  onScale?: (scale: number) => void;\n  // 旋转回调\n  onRotate?: (rotate: number) => void;\n};\n\nconst initialState: PhotoSliderState = {\n  x: 0,\n  touched: false,\n  pause: false,\n  lastCX: undefined,\n  lastCY: undefined,\n  bg: undefined,\n  lastBg: undefined,\n  overlay: true,\n  minimal: true,\n  scale: 1,\n  rotate: 0,\n};\n\nexport default function PhotoSlider(props: IPhotoSliderProps) {\n  const {\n    loop = 3,\n    speed: speedFn,\n    easing: easingFn,\n    photoClosable,\n    maskClosable = true,\n    maskOpacity = defaultOpacity,\n    pullClosable = true,\n    bannerVisible = true,\n    overlayRender,\n    toolbarRender,\n    className,\n    maskClassName,\n    photoClassName,\n    photoWrapClassName,\n    loadingElement,\n    brokenElement,\n    images,\n    index: controlledIndex = 0,\n    onIndexChange: controlledIndexChange,\n    visible,\n    onClose,\n    afterClose,\n    portalContainer,\n  } = props;\n\n  const [state, updateState] = useSetState(initialState);\n  const [innerIndex, updateInnerIndex] = useState(0);\n\n  const {\n    x,\n    touched,\n    pause,\n\n    lastCX,\n    lastCY,\n\n    bg = maskOpacity,\n    lastBg,\n    overlay,\n    minimal,\n\n    scale,\n    rotate,\n    onScale,\n    onRotate,\n  } = state;\n\n  // 受控 index\n  const isControlled = props.hasOwnProperty('index');\n  const index = isControlled ? controlledIndex : innerIndex;\n  const onIndexChange = isControlled ? controlledIndexChange : updateInnerIndex;\n  // 内部虚拟 index\n  const virtualIndexRef = useRef(index);\n\n  // 当前图片\n  const imageLength = images.length;\n  const currentImage: DataType | undefined = images[index];\n\n  // 是否开启\n  // noinspection SuspiciousTypeOfGuard\n  const enableLoop = typeof loop === 'boolean' ? loop : imageLength > loop;\n\n  // 显示动画处理\n  const [realVisible, activeAnimation, onAnimationEnd] = useAnimationVisible(visible, afterClose);\n\n  useIsomorphicLayoutEffect(() => {\n    // 显示弹出层，修正正确的指向\n    if (realVisible) {\n      updateState({\n        pause: true,\n        x: index * -(innerWidth + horizontalOffset),\n      });\n      virtualIndexRef.current = index;\n      return;\n    }\n    // 关闭后清空状态\n    updateState(initialState);\n  }, [realVisible]);\n\n  const { close, changeIndex } = useMethods({\n    close(evt?: React.MouseEvent | React.TouchEvent) {\n      if (onRotate) {\n        onRotate(0);\n      }\n      updateState({\n        overlay: true,\n        // 记录当前关闭时的透明度\n        lastBg: bg,\n      });\n      onClose(evt);\n    },\n    changeIndex(nextIndex: number, isPause: boolean = false) {\n      // 当前索引\n      const currentIndex = enableLoop ? virtualIndexRef.current + (nextIndex - index) : nextIndex;\n      const max = imageLength - 1;\n      // 虚拟 index\n      // 非循环模式，限制区间\n      const limitIndex = limitNumber(currentIndex, 0, max);\n      const nextVirtualIndex = enableLoop ? currentIndex : limitIndex;\n      // 单个屏幕宽度\n      const singlePageWidth = innerWidth + horizontalOffset;\n\n      updateState({\n        touched: false,\n        lastCX: undefined,\n        lastCY: undefined,\n        x: -singlePageWidth * nextVirtualIndex,\n        pause: isPause,\n      });\n\n      virtualIndexRef.current = nextVirtualIndex;\n      // 更新真实的 index\n      const realLoopIndex = nextIndex < 0 ? max : nextIndex > max ? 0 : nextIndex;\n      if (onIndexChange) {\n        onIndexChange(enableLoop ? realLoopIndex : limitIndex);\n      }\n    },\n  });\n\n  useEventListener('keydown', (evt: KeyboardEvent) => {\n    if (visible) {\n      switch (evt.key) {\n        case 'ArrowLeft':\n          changeIndex(index - 1, true);\n          break;\n        case 'ArrowRight':\n          changeIndex(index + 1, true);\n          break;\n        case 'Escape':\n          close();\n          break;\n      }\n    }\n  });\n\n  function handlePhotoTap(closeable: boolean | undefined) {\n    return closeable ? close() : updateState({ overlay: !overlay });\n  }\n\n  function handleResize() {\n    updateState({\n      x: -(innerWidth + horizontalOffset) * index,\n      lastCX: undefined,\n      lastCY: undefined,\n      pause: true,\n    });\n    virtualIndexRef.current = index;\n  }\n\n  function handleReachVerticalMove(clientY: number, nextScale?: number) {\n    if (lastCY === undefined) {\n      updateState({\n        touched: true,\n        lastCY: clientY,\n        bg,\n        minimal: true,\n      });\n      return;\n    }\n    const opacity =\n      maskOpacity === null ? null : limitNumber(maskOpacity, 0.01, maskOpacity - Math.abs(clientY - lastCY) / 100 / 4);\n\n    updateState({\n      touched: true,\n      lastCY,\n      bg: nextScale === 1 ? opacity : maskOpacity,\n      minimal: nextScale === 1,\n    });\n  }\n\n  function handleReachHorizontalMove(clientX: number) {\n    if (lastCX === undefined) {\n      updateState({\n        touched: true,\n        lastCX: clientX,\n        x,\n        pause: false,\n      });\n      return;\n    }\n    const originOffsetClientX = clientX - lastCX;\n    let offsetClientX = originOffsetClientX;\n\n    // 第一张和最后一张超出距离减半\n    if (\n      !enableLoop &&\n      ((index === 0 && originOffsetClientX > 0) || (index === imageLength - 1 && originOffsetClientX < 0))\n    ) {\n      offsetClientX = originOffsetClientX / 2;\n    }\n\n    updateState({\n      touched: true,\n      lastCX: lastCX,\n      x: -(innerWidth + horizontalOffset) * virtualIndexRef.current + offsetClientX,\n      pause: false,\n    });\n  }\n\n  function handleReachMove(reachPosition: ReachType, clientX: number, clientY: number, nextScale?: number) {\n    if (reachPosition === 'x') {\n      handleReachHorizontalMove(clientX);\n    } else if (reachPosition === 'y') {\n      handleReachVerticalMove(clientY, nextScale);\n    }\n  }\n\n  function handleReachUp(clientX: number, clientY: number) {\n    const offsetClientX = clientX - (lastCX ?? clientX);\n    const offsetClientY = clientY - (lastCY ?? clientY);\n    let willClose = false;\n    // 下一张\n    if (offsetClientX < -maxMoveOffset) {\n      changeIndex(index + 1);\n      return;\n    }\n    // 上一张\n    if (offsetClientX > maxMoveOffset) {\n      changeIndex(index - 1);\n      return;\n    }\n    const singlePageWidth = innerWidth + horizontalOffset;\n    // 当前偏移\n    const currentTranslateX = -singlePageWidth * virtualIndexRef.current;\n\n    if (Math.abs(offsetClientY) > 100 && minimal && pullClosable) {\n      willClose = true;\n      close();\n    }\n    updateState({\n      touched: false,\n      x: currentTranslateX,\n      lastCX: undefined,\n      lastCY: undefined,\n      bg: maskOpacity,\n      overlay: willClose ? true : overlay,\n    });\n  }\n  // 截取相邻的图片\n  const adjacentImages = useAdjacentImages(images, index, enableLoop);\n\n  if (!realVisible) {\n    return null;\n  }\n\n  const currentOverlayVisible = overlay && !activeAnimation;\n  // 关闭过程中使用下拉保存的透明度\n  const currentOpacity = visible ? bg : lastBg;\n  // 覆盖物参数\n  const overlayParams: OverlayRenderProps | undefined = onScale &&\n    onRotate && {\n      images,\n      index,\n      visible,\n      onClose: close,\n      onIndexChange: changeIndex,\n      overlayVisible: currentOverlayVisible,\n      overlay: currentImage && currentImage.overlay,\n      scale,\n      rotate,\n      onScale,\n      onRotate,\n    };\n  // 动画时间\n  const currentSpeed = speedFn ? speedFn(activeAnimation) : defaultSpeed;\n  const currentEasing = easingFn ? easingFn(activeAnimation) : defaultEasing;\n  const slideSpeed = speedFn ? speedFn(3) : defaultSpeed + 200;\n  const slideEasing = easingFn ? easingFn(3) : defaultEasing;\n\n  return (\n    <SlidePortal\n      className={`PhotoView-Portal${!currentOverlayVisible ? ' PhotoView-Slider__clean' : ''}${\n        !visible ? ' PhotoView-Slider__willClose' : ''\n      }${className ? ` ${className}` : ''}`}\n      role=\"dialog\"\n      onClick={(e) => e.stopPropagation()}\n      container={portalContainer}\n    >\n      {visible && <PreventScroll />}\n      <div\n        className={`PhotoView-Slider__Backdrop${maskClassName ? ` ${maskClassName}` : ''}${\n          activeAnimation === 1\n            ? ' PhotoView-Slider__fadeIn'\n            : activeAnimation === 2\n            ? ' PhotoView-Slider__fadeOut'\n            : ''\n        }`}\n        style={{\n          background: currentOpacity ? `rgba(0, 0, 0, ${currentOpacity})` : undefined,\n          transitionTimingFunction: currentEasing,\n          transitionDuration: `${touched ? 0 : currentSpeed}ms`,\n          animationDuration: `${currentSpeed}ms`,\n        }}\n        onAnimationEnd={onAnimationEnd}\n      />\n      {bannerVisible && (\n        <div className=\"PhotoView-Slider__BannerWrap\">\n          <div className=\"PhotoView-Slider__Counter\">\n            {index + 1} / {imageLength}\n          </div>\n          <div className=\"PhotoView-Slider__BannerRight\">\n            {toolbarRender && overlayParams && toolbarRender(overlayParams)}\n            <CloseIcon className=\"PhotoView-Slider__toolbarIcon\" onClick={close} />\n          </div>\n        </div>\n      )}\n      {adjacentImages.map((item: DataType, currentIndex) => {\n        // 截取之前的索引位置\n        const nextIndex =\n          !enableLoop && index === 0 ? index + currentIndex : virtualIndexRef.current - 1 + currentIndex;\n\n        return (\n          <PhotoBox\n            key={enableLoop ? `${item.key}/${item.src}/${nextIndex}` : item.key}\n            item={item}\n            speed={currentSpeed}\n            easing={currentEasing}\n            visible={visible}\n            onReachMove={handleReachMove}\n            onReachUp={handleReachUp}\n            onPhotoTap={() => handlePhotoTap(photoClosable)}\n            onMaskTap={() => handlePhotoTap(maskClosable)}\n            wrapClassName={photoWrapClassName}\n            className={photoClassName}\n            style={{\n              left: `${(innerWidth + horizontalOffset) * nextIndex}px`,\n              transform: `translate3d(${x}px, 0px, 0)`,\n              transition: touched || pause ? undefined : `transform ${slideSpeed}ms ${slideEasing}`,\n            }}\n            loadingElement={loadingElement}\n            brokenElement={brokenElement}\n            onPhotoResize={handleResize}\n            isActive={(currentImage && currentImage.key) === item.key}\n            expose={updateState}\n          />\n        );\n      })}\n      {!isTouchDevice && bannerVisible && (\n        <>\n          {(enableLoop || index !== 0) && (\n            <div className=\"PhotoView-Slider__ArrowLeft\" onClick={() => changeIndex(index - 1, true)}>\n              <ArrowLeft />\n            </div>\n          )}\n          {(enableLoop || index + 1 < imageLength) && (\n            <div className=\"PhotoView-Slider__ArrowRight\" onClick={() => changeIndex(index + 1, true)}>\n              <ArrowRight />\n            </div>\n          )}\n        </>\n      )}\n      {overlayRender && overlayParams && (\n        <div className=\"PhotoView-Slider__Overlay\">{overlayRender(overlayParams)}</div>\n      )}\n    </SlidePortal>\n  );\n}\n","import { useReducer, useRef } from 'react';\nimport type { ActiveAnimationType } from '../types';\nimport useForkedVariable from './useForkedVariable';\n\n/**\n * 动画关闭处理真实关闭状态\n * 通过 onAnimationEnd 回调实现 leaveCallback\n */\nexport default function useAnimationVisible(\n  visible: boolean | undefined,\n  afterClose?: () => void,\n): [realVisible: boolean | undefined, activeAnimation: ActiveAnimationType, onAnimationEnd: () => void] {\n  const [, handleRender] = useReducer((c) => !c, false);\n\n  const activeAnimation = useRef<ActiveAnimationType>(0);\n\n  // 可见状态分支\n  const [realVisible, modifyRealVisible] = useForkedVariable(visible, (modify) => {\n    // 可见状态：设置进入动画\n    if (visible) {\n      modify(visible);\n      activeAnimation.current = 1;\n    } else {\n      activeAnimation.current = 2;\n    }\n  });\n\n  function onAnimationEnd() {\n    // 动画结束后触发渲染\n    handleRender();\n    // 结束动画：设置隐藏状态\n    if (activeAnimation.current === 2) {\n      modifyRealVisible(false);\n      // 触发隐藏回调\n      if (afterClose) {\n        afterClose();\n      }\n    }\n    // 重置状态\n    activeAnimation.current = 0;\n  }\n\n  return [\n    /**\n     * 真实可见状态\n     */\n    realVisible,\n    /**\n     * 正在进行的动画\n     */\n    activeAnimation.current,\n    /**\n     * 动画结束后回调\n     */\n    onAnimationEnd,\n  ];\n}\n","import { useRef, useMemo } from 'react';\n\n/**\n * 逻辑分叉变量处理\n * 此 hook 不触发额外渲染\n */\nexport default function useForkedVariable<T>(initial: T, updater: (modify: (variable: T) => void) => void) {\n  // 初始分叉变量\n  const forkedRef = useRef(initial);\n\n  function modify(next: T) {\n    forkedRef.current = next;\n  }\n\n  useMemo(() => {\n    // 参数变化之后同步内部分叉变量\n    updater(modify);\n  }, [initial]);\n\n  return [forkedRef.current, modify] as const;\n}\n","import { useMemo } from 'react';\nimport type { DataType } from '../types';\n\n/**\n * 截取相邻三张图片\n */\nexport default function useAdjacentImages(images: DataType[], index: number, loop: boolean) {\n  return useMemo(() => {\n    const imageLength = images.length;\n    if (loop) {\n      const connected = images.concat(images).concat(images);\n      return connected.slice(imageLength + index - 1, imageLength + index + 2);\n    }\n    return images.slice(Math.max(index - 1, 0), Math.min(index + 2, imageLength + 1));\n  }, [images, index, loop]);\n}\n","import React, { useMemo, useRef } from 'react';\nimport type { DataType, PhotoProviderBase } from './types';\nimport useMethods from './hooks/useMethods';\nimport useSetState from './hooks/useSetState';\nimport PhotoContext from './photo-context';\nimport PhotoSlider from './PhotoSlider';\n\nexport interface PhotoProviderProps extends PhotoProviderBase {\n  children: React.ReactNode;\n  onIndexChange?: (index: number, state: PhotoProviderState) => void;\n  onVisibleChange?: (visible: boolean, index: number, state: PhotoProviderState) => void;\n}\n\ntype PhotoProviderState = {\n  images: DataType[];\n  visible: boolean;\n  index: number;\n};\n\nconst initialState: PhotoProviderState = {\n  images: [],\n  visible: false,\n  index: 0,\n};\n\nexport default function PhotoProvider({ children, onIndexChange, onVisibleChange, ...restProps }: PhotoProviderProps) {\n  const [state, updateState] = useSetState(initialState);\n  const uniqueIdRef = useRef(0);\n  const { images, visible, index } = state;\n\n  const methods = useMethods({\n    nextId() {\n      return (uniqueIdRef.current += 1);\n    },\n    update(imageItem: DataType) {\n      const currentIndex = images.findIndex((n) => n.key === imageItem.key);\n      if (currentIndex > -1) {\n        const nextImages = images.slice();\n        nextImages.splice(currentIndex, 1, imageItem);\n        updateState({\n          images: nextImages,\n        });\n        return;\n      }\n      updateState((prev) => ({\n        images: prev.images.concat(imageItem),\n      }));\n    },\n    remove(key: number) {\n      updateState((prev) => {\n        const nextImages = prev.images.filter((item) => item.key !== key);\n        const nextEndIndex = nextImages.length - 1;\n        return {\n          images: nextImages,\n          index: Math.min(nextEndIndex, index),\n        };\n      });\n    },\n    show(key: number) {\n      const currentIndex = images.findIndex((item) => item.key === key);\n      updateState({\n        visible: true,\n        index: currentIndex,\n      });\n      if (onVisibleChange) {\n        onVisibleChange(true, currentIndex, state);\n      }\n    },\n  });\n\n  const fn = useMethods({\n    close() {\n      updateState({\n        visible: false,\n      });\n\n      if (onVisibleChange) {\n        onVisibleChange(false, index, state);\n      }\n    },\n    changeIndex(nextIndex: number) {\n      updateState({\n        index: nextIndex,\n      });\n\n      if (onIndexChange) {\n        onIndexChange(nextIndex, state);\n      }\n    },\n  });\n\n  const value = useMemo(() => ({ ...state, ...methods }), [state, methods]);\n\n  return (\n    <PhotoContext.Provider value={value}>\n      {children}\n      <PhotoSlider\n        images={images}\n        visible={visible}\n        index={index}\n        onIndexChange={fn.changeIndex}\n        onClose={fn.close}\n        {...restProps}\n      />\n    </PhotoContext.Provider>\n  );\n}\n","/* eslint-disable @typescript-eslint/no-unused-vars */\nimport type React from 'react';\nimport { Children, cloneElement, useContext, useEffect, useMemo, useRef } from 'react';\nimport useInitial from './hooks/useInitial';\nimport useMethods from './hooks/useMethods';\nimport type { PhotoContextType } from './photo-context';\nimport PhotoContext from './photo-context';\nimport type { PhotoRenderParams } from './types';\n\nexport interface PhotoViewProps {\n  /**\n   * 图片地址\n   */\n  src?: string;\n  /**\n   * 自定义渲染，优先级比 src 低\n   */\n  render?: (props: PhotoRenderParams) => React.ReactNode;\n  /**\n   * 自定义覆盖节点\n   */\n  overlay?: React.ReactNode;\n  /**\n   * 自定义渲染节点宽度\n   */\n  width?: number;\n  /**\n   * 自定义渲染节点高度\n   */\n  height?: number;\n  /**\n   * 子节点，一般为缩略图\n   */\n  children?: React.ReactElement;\n  /**\n   * 触发的事件\n   */\n  triggers?: ('onClick' | 'onDoubleClick')[];\n}\n\nconst PhotoView: React.FC<PhotoViewProps> = ({\n  src,\n  render,\n  overlay,\n  width,\n  height,\n  triggers = ['onClick'],\n  children,\n}) => {\n  const photoContext = useContext<PhotoContextType>(PhotoContext);\n  const key = useInitial(() => photoContext.nextId());\n  const originRef = useRef<HTMLElement>(null);\n\n  useEffect(() => {\n    return () => {\n      photoContext.remove(key);\n    };\n  }, []);\n\n  function invokeChildrenFn(eventName: string, e: React.SyntheticEvent) {\n    if (children) {\n      const eventFn = children.props[eventName];\n      if (eventFn) {\n        eventFn(e);\n      }\n    }\n  }\n\n  const fn = useMethods({\n    render(props: PhotoRenderParams) {\n      return render && render(props);\n    },\n    show(eventName: string, e: React.MouseEvent) {\n      photoContext.show(key);\n      invokeChildrenFn(eventName, e);\n    },\n  });\n\n  const eventListeners = useMemo(() => {\n    const listener = {};\n    triggers.forEach((eventName) => {\n      listener[eventName] = fn.show.bind(null, eventName);\n    });\n    return listener;\n  }, []);\n\n  useEffect(() => {\n    photoContext.update({\n      key,\n      src,\n      originRef,\n      render: fn.render,\n      overlay,\n      width,\n      height,\n    });\n  }, [src]);\n\n  if (children) {\n    return Children.only(cloneElement(children, { ...eventListeners, ref: originRef }));\n  }\n  return null;\n};\n\nexport default PhotoView;\n","import { useRef } from 'react';\n\nexport default function useInitial<T extends (...args: any) => any>(callback: T) {\n  const { current } = useRef({ sign: false, fn: undefined as ReturnType<T> });\n  if (!current.sign) {\n    current.sign = true;\n    current.fn = callback();\n  }\n  return current.fn;\n}\n"]},"metadata":{},"sourceType":"module"}